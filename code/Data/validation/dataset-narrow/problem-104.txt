On the SonicWALL, configure: Configure X2 on the SonicWALL with a free IP on the VoIP subnet, let's say: 172.21.1.2/24. If the vendor controls this subnet ask them for a free IP, otherwise do an IP Scan. Under Network | PortShield Group, edit X2 and ensure it is Unassigned (not assigned to X1). Then under Network | Interfaces, edit X2. Assign it to the LAN zone (assuming you trust the VoIP traffic - if you don't then use DMZ and you will need to create Firewall rules; choose LAN if you're unsure, to start). Set it for a Static IP, configure the IP, and other settings as desired. Note: A route will automatically be created under Network | Routing (from Any to X2 Subnet, for Any Service). If you selected X2 Zone = LAN the Firewall rules will already be created (assuming Interface Trust is enabled for the LAN zone, which it is by default). If you set X2 Zone = DMZ you will need to go to Firewall | Access Rules. Create or edit rule from LAN > DMZ, and DMZ > LAN for the X0 and X2 interface (I would suggest keeping things wide open, Any/Any/Any, during testing and then tighten up after if needed). Connect X2 to the VoIP switch. On the Phone Router: NOW: you or the Phone Vendor will need to create a route on the other router. No IP or interface needs to be configured. The route will need to be: 

Note: when you say "if you bypass the sonic wall speeds through the switch are fine" do you mean that you have configured each computer with a public static IP (because bypassing the SonicWALL means no DHCP and no NAT from the router and many ISPs only provide 1 or 2 public addresses via DHCP). 

When traffic arrives into a PE router from a customer the interface that it arrives on is associated with a VRF. The router will only lookup the destination in the VRF routing table for the associated VRF. If the interface is associated with VRF A, the router will only be able to see the 172.0.2.5 that exists within VRF A. If the interface is associated with VRF B, the router will only be able to see the 172.0.2.5 that exists within VRF B. The router will either forward the traffic locally out of another interface associated with the same VRF, or if the destination is on another PE router the traffic is encapsulated in MPLS and forwarded to the egress PE router. If you are familiar with VLANs, VRFs are very similar, but at L3 instead of L2. When a frame arrives on switch, the port is associated with a VLAN and the switch looks up the destination MAC address in the MAC address table for that VLAN. The same concept exists for VRFs at layer 3. When a packet arrives on a router, the interface is associated with a VRF and the switch looks up the destination IP address in the routing table for that VRF and then forwards out of that interface (which is also in the same VRF). 

OSPF does not require neighbors to be on the same IP network if the network type is point-to-point. An adjacency will form even if the interfaces are unnumbered. In this case, they are both on the 10.1/16 network though. 

The problem is likely that you have VLAN tagging mismatch between the two SonicWALLs. How are they connected? With a switch? Or some other device? (an ISP's MPLS device of some kind?) Note: I am going to assume on SonicWALL B that the interface is X3, since you don't state it -- just so things are clear. Your packet counts are for X0. If SonicWALL A has: 

If your GSM Wifi Hotspot has an Ethernet port you could connect X1 (WAN) there and it should work; that would be simplest. If NOT then you will need to put W0 (Wireless) into Wireless Bridge Mode: $URL$ However, in both cases, you will need to ensure the correct ports within GSM Wifi hotspot router are open for VPNs: 

That's to allow the remote site to initiate the connection, you would need to publish/NAT inbound those ports to the W0 interface if you wanted to initiate from the central office to the remote site. I would suggest testing this before sending any equipment out as the little routers inside those hotspots are often troublesome. If it works please post back with the make and model. 

Make a similar route on Dallas router (but swap all the IPs, so from a Dallas IP to the Arlington IP, the Gateway will be 10.99.9.1 this time). I would suggest using something like LAN Speed Test (even the free version): $URL$ To test the speed to/from your test machines over the VPN first and then again after putting the routes in. You should see a speed difference as the traffic goes over the MPLS. If that works then change the routes so the: Source is: Any And the Destination is: The network on the other side (instead of just an IP) -- so from Arlington the Destination would be: 10.74.2.0/24. Metric: still lower than the VPN Tunnel route. All the traffic will go over the MPLS for everybody. This can be done lunch time as the interruption is very minimal. As long as the Zones for X2 are the same as your X0 networks then no Firewall rules should be needed if you have Interface Trust enabled for the LAN Zone. I don't believe you will need to make any changes to NAT as everything will be routed (with respect to the internal networks). You could then disable the VPN, or leave it and configure Probes on the routes, so that the MPLS' routes are disabled if the probe fails (allowing it to fall back to the VPN. Less useful if it's the same ISP in both cases...) And yes: backup your configs FIRST, and again after :) 

If you look at the type 1 Router LSA for an ABR or ASBR it will have the E flag set if it is an ASBR and the B flag set if it is an ABR RFC 2328 A.4.2 page 206 

No, the addresses still need to be unique on the links. Looking at your configuration S0/0/0 on R1 is connected to S0/0/0 on R2, so if you used the same address on both, they wouldn't be able to communicate using the link-local addresses. You could get away with using the same addresses on the gigabit interfaces, as they are not connected, but that is not good practice and could lead to issues in the future if they were connected. Best to use the same unique address per router. 

It depends what you are advertising into LDP. If your ping is to a destination address that is advertised by LDP and there is an end-to-end LSP for that destination, then the ping will be encapsulated and MPLS switched, even if the destination is in the global table. This is how the outer (tunnel) LSP works in MPLS VPN By default Cisco networks advertise all global networks into LDP. Therefore by default all global traffic is MPLS switched. It is best practice to filter the LDP announcements to only cover the loopback addresses of the PE routers as there is usually no need to use MPLS for any other internal networks. The command mpls ldp advertise-labels for ACL to ACL is used to control advertisement of labels for specific prefixes to LDP peers. If you want to check whether a destination will be MPLS forwarded, try “show ip cef destination-ip detail”, if you see a label value after the next-hop then you know the IP packet will be MPLS encapsulated and label switched at least to the next-hop. You can also check the MPLS forwarding table (show mpls forwarding-table) and that will show the inbound and outbound labels as well as the prefix. You may also get a situation where traffic is MPLS encapsulated in only one direction, so the traffic follows an LSP to the destination, but is not encapsulated on the way back. If you are only advertising loopbacks via LDP and you send a ping to a loopback destination address, but source the ping from an IP that is not advertised by LDP then the ping will follow an LSP to the destination, but the return traffic will be normally IP switched (no MPLS) back to the source. Another thing to consider is penultimate hop popping. If the destination is only a single hop away, the other LSR will advertise a null label. In this case, instead of labelling the traffic the router will forward the raw IP packet to reduce the number of lookups required on the destination router. In this scenario your traffic is unlabelled, although technically it is following an LSP. ECMP with MPLS works in a similar way to normal CEF load balancing. If there are two different equal cost next-hops for a destination, the MPLS traffic will also be load balanced between the two destinations, using separate LSPs. If you look at the output from “show ip cef destination-ip internal” it may show you the load balancing 

You'll see one for your X0 subnet. I suspect this isn't the problem but you can look. Chances are you have either managed to disable NAT or have a Firewall rule blocking the traffic. 

If you were testing with a PC connected to the VoIP network (with a 172.21.1.x IP) the Windows route command would be: 

Put all of them into an Address Object Group called: SERVER-16 Public IPs (or whatever) Then create an inbound NAT rule that uses that Address Object Group for the Destination, like: 

Your question doesn't list any specific IPs so I'm just going to make some assumptions, change them as needed. You can do what you want, DHCP is broadcast only within the local subnet (won't be passed by a router unless you configure specific options to do so). Assuming: SonicWALL: 

Both in the LAN zone, both in Static IP mode. Connect X2 to the PtP interfaces of your ISP's device (eg. the MPLS). This assumes the link is just a Layer 2 link, no routing is being done by the ISP. You should then be able to use the Diagnostic Ping (or CLI ping) commands from each router to ping the other router's X2 interface (eg. Arlington should be able to ping 10.99.9.2. If things are working then you can create a Routing policy to test: So on the Arlington router: 

Ron is correct, SonicWALLs will not do DNS Proxy/redirection or act as a DNS forwarder. BUT you can use NAT rules to accomplish the same thing! If you need your SonicWALL to act as a DNS resolver for LAN clients then configure a loopback NAT rule like so: 

It's usually incompatibility, not just with your own hardware, but also that of companies you peer with. I requested an ASN about 3-4 years ago and RIPE provided a 32-bit ASN. We could peer with our ISPs OK, but free peering at public Internet exchanges didn't always work. We requested a 16-bit one in the end. This was a few years ago now, so things may have moved on. I would still go with the 32-bit, you can request a 16-bit if you have specific problems. 

For A and B, each ABR will now have two sources of information for each network. There will be the original type 1 or type 2 LSA and also a type 3 LSA. The order of precedence is to prefer type 1 and type 2 over type 3, so only the type 1 or type 2 LSA is used in the routing calculation. For C, the ABR will have the original type 3 (within area 0 LSDB) and it will also have a type 3 received within area 1. In this case, it will ignore the LSA from within area 1 and will only use the LSA from the backbone for its calculations. 

First, does R3 support BGP and does it have enough RAM to support all the routes on R1 and R2? If not, then BGP isn't an option. Second, do R1 and R2 receive a full Internet routing table? If so, then redistributing several 100k routes into OSPF would not be wise if at all possible. In this case I'd recommend using iBGP. On the other hand, if R1 and R2 are only receiving default routes, or a small number of routes, then redistributing into OSPF would be the preferred option and would allow the routing information to reach other OSPF only routers in the internal network so that they can make more informed routing decisions. 

The answer will depend on where most of your internal LAN traffic will be going: If most of your LAN traffic is INTERNALLY BOUND (ie, to a local File Server, Terminal Server, Intranet server, etc) then you definitely want to choose 1 switch as your "main/core" switch and connect the SonicWALL's LAN to it, along with the 2nd switch and any other switches. Plug the server(s) into the main switch, along with the most critical workstations. The reason for this is: if most traffic is internal then you don't want to waste the SonicWALL's resources switching those frames from Switch #1 to Switch #2 -- in fact it is probably not as fast as the dedicated switches doing that. If you plugged both switches into the SonicWALL's LAN ports then ALL traffic from Switch #1 to Switch #2 would go through the SonicWALL. If most of your LAN traffic is EXTERNALLY BOUND (ie, to the Internet; eg. you have few internal resources and connect mainly to Cloud Based resources, like Office 365 or various websites) then it may actually make sense to connect both switches separately to the SonicWALL's LAN ports. The reason for this is: if most of your traffic is going out through the SonicWALL then you might as well connect directly to the SonicWALL instead of having one switch pass additional frames from the 2nd switch. Plus if the "main" switch were to fail then the other switch would still be connected. In either case if you have separate subnets/VLANs then I wouldn't change anything -- your Dell X1052 switches are Layer 2 only so any routing of packets from one network/subnet/VLAN to another will require the SonicWALL router to route those packets. It wouldn't matter if you configured one of your LAN ports to be on a different network/subnet (eg. a DMZ) or if you configured an internal interface and trunked 1 or more VLANs through a single port. In both cases the SonicWALL is doing all the routing. [Of course if you have a large/complex network with multiple subnets I would recommend a Layer 3 switch to off load from the SonicWALL. The SonicWALL's job is firewall/UTM/packet inspection and it is not going to be as fast as a switch at either plain old layer 2 switching or layer 3 routing.] 

It looks like it is possible to configure VRRP as active/active when used with MC-LAG. See this document: $URL$ 

The HTTP PDU is split between three TCP segments: frames 22743, 22744 and 22746. Wireshark shows the first two segments as-is, but for the third segment, the HTTP PDU is reassembled as frame 22746. The Ethernet/IP/TCP headers for frame 22746 are that of the original frame, but the TCP payload (the HTTP PDU) is the reconstructed PDU from all three segments. If you look at the detail for segments 22743: 

It looks like you are using serial interfaces which use OSPF point-to-point network types as there can only be two devices on a serial link. DRs are only used on multi-access networks to reduce the number of adjacencies. They are not used on point-to-point networks, so both routers should be fully adjacent with each other . 

The way I see it, forwarding applies to forwarding at any layer. A frame/packet/cell arrives at a device, a header address is inspected and that address is looked up in the forwarding table, the forwarding decision is made and the datagram is sent out of that interface on its way. Routing describes this function when the forwarding decision is made at layer 3, using the IP destination address. Switching and bridging refer to the forwarding decision being made at layer 2, using the destination MAC address. I know there is some confusion around this as I have seen layer 3 forwarding referred to as switching when it is carried out on an L3 switch.