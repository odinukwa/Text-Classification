There are two "central" locations each one having one satellite or spoke site. Let's have: - zone A and its spoke_zone A1 - zone E and its spoke_zone E1. Both region A and region E have a similar deployment scenarios: - 1 x 5508 WLC - several LWAPs in the existing network (local network). - FlexConnect for other several LWAPs for the spoke zones A for the A1 and E for the E1. I'm thinking how can I achieve a backup solution for all these 4 sites: - A1 and E1 can achieve it through FlexConnect and one mode only: local switching & local authentication. - what about A and E regions? How can I bring some backup WLC solution here? I know of Mobility Groups, still I don't think it helps too much as I have only L3 connectivity between A and E region through MPLS. What if I try and get L2 connectivity in between using some solutions like "poor-man's EoMPLS" like L2TP v3, I will be able to connect one VLAN pair, will this be enough ? - what else can I do in case of WLC breakdown in either of the two regions (A or E)? 

Yes, VPN routers are also routers. So you just have to carefully read the router datasheet/documentation. If you are looking to "vpn router", this usually names a small business product, marketed with VPN to make you buy it. I wouldn't expect to have broad capabilities, nevertheless some products allows you to splin LAN into several VLANs or at least use one port as DMZ (basically offering you two "Lan ports"). 

I have always been told during my network education that the Internet (and any computer network) is and should be designed so that the intelligence is not located on the core of the network. The core should only have the "dumb" objective to only deliver the data. That means no big firewall on the center, no content-serving, etc. While I completely agree with this design, I'm looking at the "why?". Why is this the best design? Is there some kind of literature (RFC, etc.) about that ? I'm looking for rational arguments in favor of this design. 

Yes it is possible, and Everton gave you some features that help you do that, but... ...please don't do it ! I know a single LAN over two (or more) distant sites seems nice for machine migration (it can keep the same IP) or auto-discovering protocols, but by bridging two remote LAN you create a single failure domain. By bridging remote LAN, you will forward every broadcast, every multicast, every broadcast storm, every shitty multicast packet that will triggeer some bug on oh-so-bugged multicast stacks on some hosts... Even for legitimate broadcast it is bad, because all of these have to be treated by everyone before being considered irrelevant by 99% of your hosts. That costs CPU. LAN do not scale !! (Hint : the "L" stands for "Local" :) ) See Ivan Pepelnjak's blog post for more detailed explanation. If you need to move a host without having to change it's IP address, consider using a mechanism where the host (or its hypervisor if applicable) announces a /32 route to your router. Calico does it with BGP, for instance. 

If you don't have access to the NAT_Firewall this will not work. Presumably that firewall will SNAT, still you need a DNAT for ISAKMP connection. A solution that probably will work would be to have two Cisco devices and use Cisco Easy VPN, one device acting as a simple client behind the NAT_Firewall. The cheapest devices would be some 88x, 89x Cisco routers with Security License enabled. 

I would suggest to create a 2nd Remote-Access tunnel group for all your remote-access users. Start migrating them, one by one and when you are done you can delete the existing Default L2L Group, or you can change the PSK. If you encounter some users that don't want to change, you can enforce a specific VPN Client version and inform them you are doing a major security update. 

I have discovered weird routing from our ISP all related to BGP. Here is the scenario (real-one). - there is a /19 prefix bought about 10 years ago, which was registered with ARIN authority. - as bussiness grew each site got it /24. The trouble starts in APNIC region in ASIA. We export one /24 prefix the regular way using two local ISPs. When trying to reach this prefix from different ASIA sites like India or China all traffic is sent to US West Coast then back to our site. Except additional hops, this also adds about 150ms latency. What I already tried: - AS prepend each ISP at a time so the other left would be preffered for all inbound traffic - both tests went similar as in both scenarios traffic hit US before reaching this trouble site. As there is no other local special config I can think of like communities, how can I explain this? Are both local ISP taking in consideration the ARIN info and based on that send traffic to US? Thanks! 

In IPv4, newborn LIRs must seek approval from the RIPE NCC before assigning a prefix larger than a certain size to end users. As time goes (and RIPE see that you fill in the RIPE database correctly), this certain size increases upon being big enough for the LIR to assign IP addresses as it wishes. This certain size is called an assignment window (AW) and is not a public information. In order to gain approval from the RIPE NCC, LIRs willing to assign a prefix bigger than the AW must fill in the appropriate form. More information on AW can be found here. Note also that trying to assign several small prefixes to overcome the AW will not work, as AW is valid over a 12 months period. (i.e. you can not assign more than a /XX to end user YYY in 12 months, without asking the RIPE first, neither in "one shot" nor via several smaller assignments.) The actual question now : while this is perfectly clear for IPv4, I cannot find explicit references to the AW in the IPv6 Assignment and Allocation policy... Does this mean that there is no AW in IPv6, or that the system is left unchanged (in that case, I cannot find the appropriate form) ? 

I have a pair of Cisco 6509 routers, which are monitored via SNMP (with Observium, to be accurate). Today we spotted a peak of CPU usage for a Switching Processor. The peak can be correlated with a peak of inbound unicast on a port named "NDE_vlan1014" (and "NDE_vlan1014" on the other router). I understand from google that NDE refers to Netflow, but I can find nowhere an explanation on what is actually graphed for that interface. It is visible only via SNMP (not in a ) and I have no vlan 1016 nor 1014. I don't see any peak in my netflow analyzer (as-stats) either... So the question is : what is this "NDE_vlan" interface ? 

Anytime possible I would use EIGRP (faster convergence and failover) over the tunnels then next in preference would be OSPF. GRE is not supported by ASA as far as I know. 

Whenever possible I would go for IPS module, it s one of the best security products available on the market. As long as you have the license just fine tune it and use it accordingly to your needs. For any other scenarios when IPS not available, threat-statistics will prove helpful. 

A reboot will surely alleviate the problem for the moment, but as time passes and router memory loads you will probably hit the same log error. You can either remove some roles you have for this router, or a more uncommon method, would be to schedule an automatic reload at every 1 week or later. 

I have deployed ASAs in similar scenarios and all went well, with careful planning and maintenance. For the outside interface, first of all secure your OSPF process using MD5. You are to connect this interface to your L2-aggregate switches. On your inside interface we can dive into: - technically you can connect it to your L3 switch so you will split the role or the load between your network devices, also makes sense for a regular firewall (if at some moment you will have issues with your L2-aggreg devices, at least the network from bottom to the firewall is working) - for this scenario as ASA is VPN-used it means you can also connect your inside to the L2-aggregation switches. Without those L2-aggreg switches your 5545 will become useless for your network. Nevertheless for this choice you have to think about monitored interfaces as all your firewall physical interfaces will be connected to one physical device. Bottom line: if I have ports and capacity for better logical and troubleshooting I would connect inside straight to L3-bottom-switches. Finally regarding your 1st question: I have used inside interface both as a shared network with the other inside firewall (you could run into some details with same-security-traffic command and also as a dedicated network, than using bottom switches connect to the rest of the network. I prefer the last one as in this case VPN L2L filtering is done on the firewall (ASA 5545) instead of group-policy ACL (and then applying it to the tunnel-group). It is easy to manage, view, troubleshoot (for me) and also it keeps me away from some ASA more delicate traffic hairpin scenarios. 

In other words, loopback interfaces are a way to have a unique IP to identify or access the device, independent of topology changes. As per Router IDs, it is usual to use the IP of the loopback interface for clarity (and most devices do this by default) but it is not mandatory at all. 

You want to look into two features called private VLAN and ARP proxy. When your host's VLAN is configured as a private VLAN, the switch will forbid your host (let's assume it has IP ) from communicating with other hosts in the same VLAN, as for instance . When I say forbid, I mean that it will not forward ethernet frames incoming from a host in the VLAN to another host in the same VLAN. That means no ARP, no ICMP, nothing. That's a bit against everything we learned in networking class but that's how it works. Bear with me because that is not all there is to know with private VLAN. The VLAN where our two hosts (host and ) are configured is known as the secondary VLAN. You can configure a port (typically the gateway's) to be a little special : this port will be in another VLAN, the primary VLAN. Both VLAN are linked somehow (configuration varies with vendors) in the switch's config. A host in the primary VLAN will be able to communicate (i.e. the switch will allow frames to be forwarded) with any hosts, whether they are in the primary or the secondary VLAN, and vice versa. So there we are. Our hosts ( and ) cannot communicate between them but can communicate with the gateway (), and, per extension, the rest of the internet. That can be very useful for hosting providers that do not want different clients to communicate and do not want to waste IP addresses in a lot of /30 networks. But that is not what you want. Yet. The twin feature of private VLAN is ARP proxy. That is just a config on the gateway to instruct it to respond on ARP requests originated from host , and asking for 's MAC, with its own MAC address. The gateway then initiate its own ARP request to . This time host sees it (the gateway is in the primary VLAN, remember?) and responds. This way, the gateway is performing some sort of legitimate man-in-the-middle between your two host, and can control the traffic. It may perform an ICMP redirect, you might want to disable that. That's it. You can now control traffic between hosts in the same subnet. Well, you need a switch with the correct features, of course ! ;) (or you can use two different VLAN, as Ron outlined.) EDIT : some more information about how private VLANs work. The primary (say VLAN ID 10) and secondary VLAN (ID 20) have different 802.1q numbers. A frame from the gateway will travel your switched network tagged with ID 10. Switches will then forward your frame to trunk ports, and access ports in VLAN 10 and 20, because of the relation between primary and secondary VLANs that is configured on the device. A frame from an isolated host will travel your network tagged as VLAN 20. It will be forwarded on trunk ports, and access ports in VLAN 10 but not access ports in VLAN 20. There is no communication involved between switches because none is required : it is only a matter of local treatment. But it is advised to have the same primaries/secondaries config on all switches, or expect headaches. If you send frames to your hosts tagged, you will have to play with and some VLAN mapping magic. Refer to your vendor's doc. Also, I only talked about isolated secondary VLANs. There are also community secondary VLANs, but that is for another time/another edit.