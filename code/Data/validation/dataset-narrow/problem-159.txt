I have a site-to-site VPN from a Cisco ASA 5512 and a Cisco 891. I want all traffic, even Internet access, to come through our ASA. The VPN is established and working. The LANs have connectivity to each other, but the remote LANs on the 891 have no Internet. I've been working on this a while, experimenting and researching, but I can't seem to figure out what I'm doing wrong. The traffic seems to be getting dropped at the ASA when doing a traceroute. I'm assuming it's a NAT rule or VPN policy. I've looked through the group policy to find nothing of interest and tried multiple NAT rules that I assumed I would need. I have the config of the ASA, the 891, and a packet-tracer output from the ASA testing a ping from a remote LAN user, 172.17.55.x to 8.8.8.8, which is dropped at phase 8 ipsec-tunnel-flow. I'm sure it's an amateur mistake I've made, but I just can't seem to find it. Any help is appreciated! ASA Config 

When the router sees a packet arrive on an interface with the command configured it checks to see is it matches any of the protocols that are "helped" by default or configured with the global command. In this case because it's DHCP the router sees that the destination port matches UDP 67 and allows the packet to be "helped". The router then changes the destination IP address from to the IP address configured by the command as well as changing the source address to the address of the router interface on which the packet arrived and passes the packet along to the rest of the routing logic. Now that the packet has a unicast destination address the router treats it like any other packet. It arps for the destination IP address (which is now that helper address) and then replaces the layer 2 addresses before sending the packet out the appropriate interface. Getting Back Again The router uses essentially the same process in reverse for the DHCP offer that is sent back to the client. The DHCP servers sends the offer to the IP address that was specified as the source address on the DHCP Discover packet. So the packet leaving the DHCP server looks like: 

If AS 6501 is willing be a transit AS then they would be able to route to your /8' however it may also depend on whether you obtained your /8 from the said ISP or not. In terms of good literature then would always highly recommend 'Routing TCP/IP Vol2' by Jeff Doyle & 'Internet Routing Architectures' by Sam Halabi. 

I am familiar with adding a secondary ip address to cisco device interfaces in order to work around corner case scenarios, for example having 2 ip subnets within the same vlan, needing to expand when one subnet is exhausted or to migrate the default gateway of a host from one address to another etc. The implementation scenarios I have seen Customers/clients use seem to point towards poor network design but I am not sure whether its usage is also perfectly valid either? I would like to know what are the main pitfalls related to using a secondary ip addresses on an interface, i.e use of the same broadcast domain, any impact upon TTL, impact on DHCP, sharing of mac address, sub-optimal routing between hosts etc? 

Layer 3 Broadcast But not Layer 2? To answer your second question, it would make no sense to have a frame with a layer 3 broadcast address without a layer 2 broadcast address. This would defeat the entire purpose of it being a broadcast frame and just not work outright. Having a unicast layer 2 destination address would not change the router's behavior at all since the router makes its decisions at layer 3. All the router cares about is that destination address and drops the packet. Where this would matter is with switches which don't care about the layer 3 address at all. The switches would only see the unicast layer 2 address. Instead of sending the packet out all interfaces on the same vlan it would use the source address table (SAT) like it would with any other unicast destination address. In effect, by assigning a unicast layer 2 address the frame is no longer a broadcast frame at all even though it has the address at layer 3. 

I've used TCP and UDP object groups for years in access rules without problems until I tried to use one in an ACL for a VPN filter. Is this just odd Cisco behavior explained by a bug/syntax error or is there a legit reason it has to be this way? Appreciate any insight! 

I have a 1941 out of the box. I can't find documentation on this anywhere, but I'm wondering if the router will pass all traffic by default without adding any ACLs? I'm curious if the implicit deny all is only triggered after you add your first ACL, or is it always there to begin with? Will the 1941 pass traffic without adding ACLs? 

I'm trying to set up a DMVPN Phase 2 configuration, but I cannot manage to get past Phase 1 because the hub router's tunnel interface refuses to disable split-horizon. The spokes never form an EIGRP adjacency to teach other and never learn routes directly to the other spokes. I'm looking for suggestions on something I may be doing wrong. I've tried disabling on the interface itself and in the routing configuration as well just be sure. When I check the interface, it still says split horizon is enabled. I haven't added any optimizations commands yet or anything unnecessary to establish communication. Once I can get my spokes talking directly, I'll worry about improving the configuration. This is solely a test environment right now. EDIT: To clarify, the fact that spokes receive no routes to other spokes and never form adjacencies tells me that split horizon is still on. The Tun1601 interface shows split horizon still enabled. Sh ip eigrp interface says thats its disabled. Short of taking a packet capture and investigating what's really happen, it seems it is in fact not disabled. Hub: 

If in different networks then pc A will determine if pc B resides on the same subnet or not by doing a binary AND operation that compares its own address and subnet mask with that of the destination address. If not within the same subnet then pc A will send the frame to its default gateway which is the router in this case, which will in turn send it onwards to the destination host if it has a determined path to that address. The router will reply to the arp with the mac address of the gateway. The router will strip off the source mac address and replace it with its own before exiting the egress interface. 

They are only used interchangeably from a perspective of each unique vlan at layer 2 should have its own subnet for addressing at layer 3 giving you separation and ability to manage broadcast traffic etc. In terms of scenarios where you would have a vlan without a subnet then only perhaps if using an 'ip unumbered' setup but there are not too many reasons to want to have to do this. If you review some best practice models like Cisco's composite network model then in terms of keeping individual subnets and your vlans 'local' to switch blocks then you would generally have a separate subnet assigned per vlan. 

Since this packet has a unicast layer 3 destination address routers will forward the packet normally until it reaches the router with an interface that has an IP address matching the destination IP of the packet. Remember from earlier that this router has the configuration on that interface still. The router checks if the packet is a DHCP Offer then rewrites the packet to become a broadcast packet and sends it back out that interface knowing that the DHCP client is somewhere on that network segment. The packet leaving the router now looks like this. 

How Routers Handle Limited and Directed Broadcasts The first thing to understand to answer your questions is that limited broadcast frames are not routed. By default when a router receives a frame with a destination address that is broadcast at either layer 2 or layer 3, the router simply drops the frame. That's why routers are said to be the boundary of broadcast domains. Some examples of these would be: 

On a related note, if you want traffic from vlan 200 to reach the outside internet you will need to create static routes on both the virgin media router and the Cisco router telling them about the other networks. On the Cisco router you need to add to tell it to forward any traffic with a destination network it doesn't know about to virgin media. On the virgin media router you need the equivalent of so that the virgin media router knows where to send traffic coming back from the internet destined for vlan 200. 

Can how can I most efficiently failover between tunnels in this scenario if the destination IPs are not reliable for the static ipsec configuration? How would I pre-empt the primary tunnel once the endpoint becomes available? 

In your example where you have 4 aligned to 252 (/22 mask = 255.255.252.0), then you have a range of 4 networks counting up from the network number. The octet where your mask changes from .255 will correspond to the octet of your host address. In this instance it is in the 3rd octet so you will have a range from 10.10.12.1 - 10.10.15.255/22, so yes they are within the same subnet. 

I have a network with resilient gateways whereby Customer sites use a default gateway to reach the internet edge routers and the primary route for traffic uses a lower metric. ipsec tunnels are initiated from vpn concentrators behind the edge routers and are statically configured to the destination tunnel endpoints which are 3rd party data centers. I am not able to use a dynamic routing protocol with the 3rd party. 

We replaced a Meraki MX with a Cisco ASA, and I'm unable to reach the public IPs of servers behind our firewall now. The server has working Internet access. All packet tracer runs show successful NATing and are allowed. The firewall is open to limit the problem while testing. I'm assuming it's a misconfigured NAT rule or another option I've forgotten to enable. I've been at it for hours, and I can't seem to ping the public IP nor access it externally for services. The ASA is directly behind the ISP modem. The server IP is 192.168.108.44 NAT'd to 5x.xx.xx.53. Any help is greatly appreciated. ISP modem settings: 

Connecting two SG500X-48's through XG1 on both sides with fiber. When I plug in the connector, the link light blinks rapidly a couple times (varies) then stops and goes dark. No connection, interface status is down. I've ran down the obvious so far. Fiber cable is good, and switches are in standalone mode. I'm mainly curious why the link light blinks then stops? Does this indicate a specific issue? (auto-neg failure, etc.) I've searched for what this means, if anything, and came up empty. Thanks 

You state Netgear switch however what you describe is for L3 routing. If configured correctly the router will respond to an arp request which is broadcast onto the lan segment with the mac address of all FF's but the router will only reply with its own mac-address if the ip it finds encapsulated in the frame is configured on one of its interfaces. If you are still telling your host device to send packets towards a different ip of 192.168.0.1 that effectively doesn't exist then it will not work. 

I find that an easy way to calculate this is if you recall your mask combinations against their powers of 2 within the binary 8 bits of an octet: 

I have a requirement to provide an accurate means to demonstrate line performance over a flat layer2 1Gb point-to-point Ethernet circuit, approx 100 miles apart that seemingly goes through a number of hops over the distance. The business requirement will need to demonstrate performance with an accuracy of min 8ms latency. The link will carry voice and data traffic whereby the service SLA should guarantee 1000Mb bandwidth. What are the known accurate methods of measuring performance given these requirements? I am aware of a number of metrics available that might possible form a test strategy but having Googled a bunch of info it can get overwhelming and i'm unclear of whether software like iPerth should be used, what's the benchmark for this scenario etc?