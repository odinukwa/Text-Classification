If you have any tmpfs file systems, it will use available memory. As memory use goes up, some of this data may be paged into the swap file. Web server processes often run with a master process to accept incoming connections, and many child processes to handle the requests. The child processes typically have the same PPID (parent process id). One of your servers appears to be running and to handle web requests, using a significant number of processes. The command , if available, is useful to see this kind of setup. 

I use shorewall to configure IP table. Use a rule like to accept from one host to port 123. ACCEPT net:192.0.2.1 $FW tcp 1234 

There are a number of tools available that are designed for scanning logs. is one of the these. You would need to setup an expression to match and configure the appropriate action. This could include temporarily blacklisting the user on the firewall. You may catch poorly configured servers that have initial retry times configured in seconds rather than minute or hours. Spambots are likely to change their sending addresses frequently so you may miss them. I've seen a number of bulk mailers retry at a fast rate using a different IP on each request. The corresponding domains, tend to be consistent on the first two or three levels. I would fix duplicates being sent by fixing the mailing list data. You will have duplicates from temporary rejects that should be retried by your mail server. Use a reasonable initial retry like 1 hour and monitor your queue for entries that have been in the queue for a while. The domain part of an email address is always case insensitive, and the left site is almost always case insensitive. Most mail servers will eliminate duplicate addresses on the same message. However, this doesn't help if messages are individualized. My server will defer delivery for over an hour for every RFC violation I detect. This includes rDNS, ELHO name matching DNS, SPF and others. There are other reasons that a message will be delayed. The reason delivery acceptance was deferred should be logged. 

After changing values in you will need to reload the Exim4 configuration. IP Routing or even name based routing can be done with the file . Add line of the format to this file. For details see the output of . You may need to modify how recipients are verified for domain1. Normally, you want this to be a callout. 

I have always scheduled cronjobs at random times (especially minutes). I commonly see cron examples that run at midnight like: 

Behind WordPress you will have a database. This need not be on the same server as the WordPress application, although it usually is. You have two options: 

Add a line to /etc/fstab. This will mount the file system at startup, The header will show you which column to place the various option. Use and man fstab for additional information. 

As James has noted you unlikely to be the administrator for the reverse zone (PTR records). Contact whoever provides your IP address and ask them to make the change. This usually takes a few days. You There will be a further day after they implement until cached values expire on other DNS servers. You could ask them if they support delegating reverse lookups. This is defined in RFC 2317. You will need to make slight modification to the above zone file for it to work. For IPv6, it should be easier to get the reverse zone delegated to you. In IPv4, you usually don't get the reverse zone delegated unless you have at least a /24 block allocated to you. 

As specified your CNAME is for . If you have a CNAME for it has to be specified in the domain. Also, you can't have any other records , , , sub-domains, etc for if it is a CNAME. EDIT You need to remove all the sub-domain records for the sub-domain, and the domain. You may need to remove the records for from the domain first. By configuring NS records for the sub-domain, you are delegating authority for the sub-domain to those name servers. To have a CNAME for , the CNAME needs to be defined in the domain, and be the only record for . As a CNAME is not allowed to have sub-domains, or any other records. It is not necessary to delegate to sub-domains. These can be handled by the domain. Defining in the domain is equivalent to defining in the sub-domain. 

You need to import the key into the keystore using a custom import. The native import functionality of does not import the key properly. I have used WebLogic to import the key. I haven't need to find a tool for Tomcat. 

It is common for proxy services to provide IPv6 to IPv4 conversion There are a few optional headers which can contain IP addresses. If you aren't using them, then there should be no issue. If your software is IPv6 capable, and you just don't have a public IPv6 address, there is less likelihood of an issue. The header most likely to have an IPv6 address is X-Forwarded-For. Cloudflare also injects a header indicating the address of the client as seen by their servers. Their option sanitizes both headers so applications that can't handle IPv6 addresses will see IPv4 addresses. You should have no issues with this option. I would urge you to upgrade to IPv6 capability, even if you don't immediately get IPv6 addresses for your servers. 

You had no listening ports because you had no listening processes. Ubuntu does a good job in this respect on a default installation. Those processes which do require a listening port usually use localhost (127.0.0.1) by default. This prevents direct access from remote systems. Applications such as Apache and SSH server are expected to listen connections from remote servers. Apache has its own ACL lists to secure access. SSH server can be secured using the hosts.allow and hosts.deny files in addition to its configuration. Applications my MySQL and PostressSQL should listen on localhost by default. If you need access from other system you will need to change their listener configuration. They will usually have one or more mechanisms for securing access. Use hosts.allow/hosts.deny for application which support this mechanism. Using a firewall builder like Shorewall to build a secure firewall helps. Understanding each application's own security mechanisms helps build depth in your mechanisms. A tool like logcheck can monitor your logs and notify you of some of the events you may need to check. I use Munin to monitor my systems and in some cases alert me of issues. This is replacing previous use of Nagion and MRTG for monitoring and graphing system usage. If you have telnet running, you can close the ports by stopping the service. Unless you really need it, remove the telnet package and replace it with ssh-server. Most telnet servers support use of hosts.allow/hosts.deny to restrict access. This also applies to applications which run under inetd or xinetd. MySQL and PostgreSQL should listen only on 127.0.0.1 which is secure from direct access from outside your server. 

I have no problems sending email to GMail over IPv6. However, I have a dedicated sub-domain for my mail server. (In my experience and research, I have found second level domains are most likely spammers.) IPv6 tends to be much easier to configure correctly for email serves (rDNS) etc. You might be flagged as the address you are using looks like it may be based on the MAC address. Try configuring the address so that you can use "::" in it. The MX in your SPF record is redundant as the IP specification already specify the addresses. Also, including Google's SPF record if you aren't using them as an MX may be a flag. I believe their policy will trump your policy. MX priorities are usually non-zero, you may want to try 10 instead. 

If you want to use 256 bit encryption, duplication each cipher in order and change 128 to 256 in one of the duplicates. There doesn't seem to be a good reason to use 256 bits, and there are reports that using 256 bits may enable some timing attacks. 

Exim usually will act as and MDA, although it will use or if they are available. If Exim is your MDA, you can setup a special router and transport that filters by spam score. This is the easiest way to add this action as the default. Base the router on the router (likely the last router), and place it right before the router. Base the transport on the transport used by the router but change the destination to the Junk mailbox (directory or file). I prefer when I want to filter email into different mailboxes. You would filter the headers for the Spam header, and write to the appropriate mailbox. 

Ziptie every cable where it shouldn't move, both at the server and at the rack. Use Velcro to bundle the extra cable length needed to run the server when it's pulled out. UPS goes at the bottom. So do battery packs. Heavier servers to the bottom. Fill panels to the top. Given increasing server densities, I would add a switch to the rack. Depending on your requirements vlans or separate switches for the management connections might be appropriate. Color code your network segments. Cable management arms tend to get in the way. Go with Velcro. Cables should be as long as needed to run the server when it is pulled out. Cables longer than that become a problem. If necessary provide zones to run out the extra length. Somewhere near the power distribution panel for power cords, and near the switch for data cables. Wider cabinets with wiring channels in sides are also an option. 

You need to backslash escape regex characters that you want to match as literals. It looks like you are using your mail is stored in Maildir format. I don't know if you excluded the header or don't have one. This will deliver files to the appropriate mail subdirectories. It includes a log file so you can verify that the messages were correctly processed. 

I reviewed the document and found the author(s) don't understand DNS propogation of new entries. When updating old entries there are configurable cache times that can be several days. However, new entries need to be fetched from the authoritative name servers before the can be cached. If keys are being rotated by the suggested process of rotating keys behind three CNAMEs, the there may be significant delays while cached entries are updated. This can be mitigated by dropping the TTL on record to be updated in the period before it is updated. The CNAME rotations may also be problematic in the case an emergency key rotation is required. Randomizing the key names does provide some small measure of protection against the public key being retrieved in advance of use. Once the key is in use, I would assume that it could have been harvested for the purpose of generating an alternate signing key. 

If you are using NUT (Network UPS Tool) to monitor your server, then your clients can do this. The host to which the UPS is connected should be the last to go down. NUT server runs on UNIX or Linux, but a client is available for Windows. There is an option to run a script on various events (with delays if desired). In your case you would want to trigger shutdown on an outage of some seconds. If you have wake on LAN you you could trigger a wake event some time after power is restored. 

Consider creating a banned IPs list and adding the IPs to it when issuing the ban request. In the action script ignore ban requests if the IP is in the list. You will also need to change the unban action to remove the IP from the banned IP list. Create a script such as the following: 

Have you looked at using version control for the templates? Users would update their templates and commit their changes. Then either periodically, or via a triggered process, the templates would be updated. Given the size of your infrastructure, it might be appropriate to provide a development server where users can edit and test their templates. This would making tracing which changes were made simpler and provide better reversion capabilities than a singe backup file. It could also be used to scan for some code injection issues on the production servers. This should scale better than copying files as only changes are transferred. 

You could use a daemon to open ports on demand. Some daemons such as will build restrictive rules which only open the ports to the requesting server. The daemon will adjust your iptables firewall by maintaining rules in a couple of chains. I investigated Firewalling Google Chat and Skype. I found that Skype is not designed to play well with firewall restrictions. Each user needs an incoming port forwarded to their device. Additional ports are required for each connection. However, it is not necessary to shut the firewall down to use Skype. Other than the incoming port for each user, you will need to enable outgoing connections on the ephemeral ports for the devices being used. Incoming restrictions can be quite tight. I was able to get working with a Shorewall firewall by adding the required chains in the configuration file. 

Wombie has given the same answer I would use for setting up radv and routing. Inet6 is designed to do self configuration without the need for a DHCP server. I don't use DHCPv6 as it can be handled by radvd and zeroconf. radvd can be configured to supply name servers, and can advertise servers from /etc/resolv.conf. New versions of radvd have also implemented distributing search lists. I configured avahi-daemon to distribute name services and servers to clients. You will need clients are able to do service discovery. I haven't done much testing of service discovery as I run a dual stack network across the board. 

It doesn't appear you have a virus, nor is it likely you are part of a botnet. Neither of these cases would want to announce their presence by getting their activity logged.