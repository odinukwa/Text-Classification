To an ancient Roman, a car is magic. We know how it works, which makes it technology. Any magic, as soon as you know how it works and how to use it, becomes technology rather than magic. If you want to have a people who have rejected one type of technology for "magic" (which is just another technology), there are many reasons to do so: 

If the people in the alternate reality in question have a basic knowledge of genetics: Females have only X sex chromosomes while males have both an X and a Y. The Y chromosome is inseparably connected to their spirit in a way that X chromosomes never are. Since these are the chromosomes responsible for developing a person's reproductive system, the reproductive contribution of a male is the spirit, where the female's is everything else. If they don't: To be honest, you probably don't even have to explain anything. Just state what happens as you did in the question and that'll be enough of an explanation on its own. 

Magic is easier to teach than the available technology (is learning casting a teleportation spell easier than driving a car or flying a plane?) Magic is less expensive to use than the available technology (is Floo Powder easier to make than jet fuel -- and the jet itself?) Magic is religiously (think Amish) or socially acceptable over technology (combustion engines require consumption of fossil fuels, which depletes the earth!) 

More viscous: silica, aluminum, potassium, sodium, and calcium (think quartz, with its highly structured molecular form) Less viscous: iron, magnesium, magnesium oxide 

... and many more. Basically whatever you can think of. But however magic works in your universe, it should be treated as an alternative technology, rather than an alternative to technology. 

"Any sufficiently advanced technology is indistinguishable from magic." -Arthur C. Clarke (more info) In other words, you should treat magic like another form of technology. Other answers have tried to argue that using magic over technology precludes the need for both education and research, but in all magic systems I can think of: 

Remember, though, that these rooms aren't empty, like in the picture above; they contain all the provisions you're holding onto in case of a siege. And remember that, due to the difficult engineering problem of constructing a cellar which the castle doesn't collapse on top of, you're not going to be building these with a lot of extra room. And here's the payoff for the bit about tornadoes above. Cities faced with tornadoes don't build extra infrastructure to protect their citizens. They use whatever they had already (so, church basements and YMCAs and so forth), the people at the top are taken care of one way or another, and the interchangeable people at the bottom of society are left to fend for themselves. (Oh, and if you think the nobles are going to give them time off work to dig themselves tunnels, you don't have a clear picture of what the serf/vassal system looked like.) And tunnels aren't that great anyway. You know how to deal with an enemy who digs tunnels? Here's what Wikipedia has to say: 

Which makes tunnels without fortified entraces an unattractive defense against fire-breathing dragons. So, how would cities under threat from dragons be designed? Well, unfortunately, they likely wouldn't be designed at all. 

Okay, so how do we compare this to what we know about the (I'm assuming) medieval societies that we're imagining facing a dragon attack? We know that many medieval cities were built around castles that served as a central fortress for the community. The laborers who worked in the city surrounding the castle would, in the event of an invasion, come inside of the castle. Now I'm going to assume that the castle predates the dragon here, because nobody in his right mind would spend the time, money, resources, and man-hours it takes to put up a castle in an area where there were constant dragon attacks. To quote an article on HowStuffWorks by Craig Freudenrich (which I can't link to with a new account), 

Magic users still need a very high level of education (otherwise Hogwarts wouldn't be necessary, or all D&D characters of all classes would know spells & be able to cast them at any time) Advances in magic only come from hermit-like mages who devote their entire lives to the study of magic (sounds like research to me!) 

One scientist referred to lobotomies as "surgically induced childhood," which would certainly be a solution to a criminal having too much intellect for their own good. 2. Brain-eating creatures In some universes there are creatures that feed upon the brains of humans, while leaving the rest of their bodies intact. For example, Mind Flayers in D&D or Ceti Eels in Star Trek both affect the brains of sentient beings in a very damaging way. However, this method has the greatest potential for getting out of hand and reducing the victim to a vegetative state, or killing them completely -- therefore, those inflicting the punishment would need to exert strict control over the creature that was unleashed on the victim's brain, stopping them as soon as their brain has been damaged enough. 3. Intellect-affecting spells If magic is a part of your world, a permanent variation of a Confusion or Curse spell could very effectively prevent their scheming. Another option is a spell of Bad Luck, which if powerful enough (and again, permanent) could effectively prevent them from making any significant intellectual breakthrough, thus foiling all their plans before they even happen. 

Depending on the tech level of your world, I see a few different solutions being plausible. 1. A lobotomy (as mentioned by A.C.A.C. in the comments) reduces the amount of complexity a person's brain can handle, by simply cutting out a portion of the physical brain. Lobotomies were widely used as a treatment for mental disorders in the 1940s and 50s: 

Nobody would bother undertaking such a project if those three thousand workers kept getting eaten alive and/or set on fire. People would just live somewhere else. So I'm envisioning a castle built to keep out invading armies, not dragons. Now, there's a problem with this. Castles, pretty much from the beginning to the end of their existence, have relied on the fact that having the higher ground is what you want in battle. Early "motte-and-bailey" castles were basically just walled buildings (often just made wood or even dirt!) put on top of a hill that would suck for an invading army to run up. And even later on, when castles started to get way more sophisticated, it was always the case that the most heavily-fortified part of the castle was also the highest off the ground. 11th-century motte-and-bailey castle 

With a question like this there are two ways to go: how would things play out in a work of fiction, and how would they play out in real life? I think a lot of people have covered the "work of fiction" angle. If you were going to design a city from scratch and with none of the real-world financial or political constraints that cities face as they grow and evolve, you'd probably have a big network of underground shelters for people to hide in when the dragons came around. But let's look at a similar real-life situation featuring unpredictable death from above: a city prone to catastrophic tornado damage. (I write this with my other browser tab open to a weather radar, because I'm currently under threat from a severe storm system right now). 

On top of that, any castle seriously intended as a fortress would feature machicolations, which are great if you want to drop rocks on the invaders scaling the side of your tower but which are probably less useful when you're facing an indiscriminate airborn flamethrower. So the parts of the castles which have been designed to be the most secure are in reality probably the least so. Moreover, these fortifications would have been constructed with the express purpose of preventing large underground structures from being built underneath them. This is due to the ancient combat tactic known as "mining," where an invading army would dig small tunnels under a building and use them to place explosives underneath the walls, hopefully breaching them. In fact, the moats that surrounding some castles were more to prevent mining than to keep out invaders on foot. The one thing a castle would have underground would be its cellars, which were designed specifically to be a bit fire-resistant. (These were still a serious weakness a couple of reasons. Remember how Guy Fawkes was going to blow up the House of Lords by setting off an explosion in its cellar? And then there's the fact that, without modern construction techniques, every extra floor you add is just another thing trying to make the castle sink into the ground.) These underground storage rooms are where, in the event of a dragon attack, you'd have the best shot at surviving. 

You seem to think those people would have an unfair advantage over, and would use it to the detriment of others. First let me say (and I'm an atheist) that jealousy is a sin. Don't be jealous. Secondly, many people have advantages over others (money, health, education, bodily strenght, intelligence, beauty, whatever), and most people agree that the same law should apply to everyone. Thirdly, most societies have laws in place to keep people from exploiting their advantages in an unfair manner, and expect wealthy people to provide to the public welfare overproportionally. Now what should happen? Some of your nonsleepers could become very rich, so they should pay higher taxes. Same applies to other rich people. Some could become politically powerful. So are some groups of people today, and most of them haven't "earned" it. Or some of them could form a syndicate to enslave the rest of mankind, which is the moment to arrest them, and put them on trial, like you do with every other group of criminals. And yes, perhaps they should have their own sports competitions in some cases, like men and women and people with disabilites do. Nothing that the legislative should be concerned with. 

Evolution does not work like you imagine. On average, all women get pregnant, wether they're good-looking or not (by whatever standard). And unless we change the usual human long-term relationship standard to a shimpanzee-style "the boss gets all the girls", also many males of the species get to be fathers. It'd take a long time for that to have a distinct, measureable effect. Powerful evolutionary pressure occurs when a change of some characteristic results in a better survival rate of the offspring. On a small island, smaller people run a smaller risk of starving, without the drawback of being easy prey, because there are likely no large predators. 

Moore, Oklahoma extends a couple of miles on either side of Interstate 35 as it passes south out of Oklahoma City on its way to Dallas. It occupies about twenty square miles, which is fairly small by the standards of this part of the country, but with a population of around 50k it's one of the ten largest cities in the state. And, unlike the larger cities of Norman and Oklahoma directly to its north and south, it's also had completely devastating tornado damage several times in the past few years. In fact, some of these tornadoes were destructive enough to merit their own Wikipedia pages. (I had a third link to post here, but I haven't got the reputation to post it yet.) Now, what I want to highlight here is basically a direct analog of what's been suggested in many of the other answers. Among the casualties of the 2013 Moore tornado were several students at the Plaza Towers elementary school, one of two Moore elementary schools destroyed by the tornado. In the days after the tornado, a proposed law requiring new schools in the state to be built with tornado shelters unsurprisingly gained a great deal of traction with the public. Now take a minute to think through what this says. It's not proposing public tornado shelters for everyone, or retrofitting existing structures, but merely that any new construction of schools will come equipped with some sort of tornado shelter. In interviews with the media, the measure was immediately dismissed by the Governor as too expensive, and nothing came of it. What did happen? Well, the city of Moore updated its building code, essentially requiring that new construction be built to withstand EF-2 tornadoes. Now, remember, the tornadoes that have repeatedly destroyed Moore are in the EF-4 and EF-5 range, not the EF-2 range. Since that probably doesn't mean anything to most people, here are the sample images from Wikipedia of EF-2 and EF-4 destruction: EF-2 damage: 

tend to have a harder time flowing past each other, and thus are more viscous. Some examples of real-life lava materials, in order of decreasing viscosity (again from this wikipedia page): 

Basically, even for viscous materials, heat tends to destroy any bonds between the molecules, allowing them to slide past each other more easily, and making the liquid less viscous. Chemical composition plays a big part too Viscosity can be defined as "resistance in the flow of a liquid." Therefore, materials with molecules that: 

Summary If you are looking to make a lava lake that creatures can plausibly swim through, a mixture of super high temperatures and compositions of iron and magnesium will most likely yield the best results. 

Water is not necessary for a planet to have an atmosphere. Planets like Mars have atmospheres without there being water on the planet. (It is worth noting that Mars' atmosphere is about 100x thinner than Earth's, but that is due to its lack of magnetic field rather than any lack of water. In fact, the article just linked states that its thin atmosphere is the reason all the surface water on Mars dried up.) Even if you need a human-breathable atmosphere, there is no need for water vapor. As explained in this answer, the atmospheric pressure and relative amounts of different gasses in the atmosphere will have a much greater effect on an atmosphere's breathability than the presence or absence of water will. As for humans needing drinking water to survive on the planet in the first place, you could have it shipped in from other planets if space travel is available, or have moisture farmers (sort of Luke's aunt and uncle on Tatooine) that mine or gather water from the sparse underground sources you mentioned. 

Hotter planets will have less viscous lava This one is pretty self-explanatory, since the hotter the temperature, the less solid almost all materials tend to be. Also, from the Wikipedia page on lava compositions: