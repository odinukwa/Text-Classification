We're planning to migrate from SBS 2003 to 2011 in a month or so, and I want to try out the upgrade process before I do it on the real server. I haven't bought the 2011 licence yet, but noticed that there is a trial version at Technet. Is the trial version complete enough to try out a migration? I also don't have a spare 2003 licence, is there a trial version of 2003 still availible? And in that case, is it upgradeable? If not, any other way of trying it out? I suppose I could use the existing licence, but that isn't really ok, is it? I'm not good enough at legalese to understand the EULAs, maybe it is considered fair use (if there is such a thing)? Any good advice in general in trying these things? I intend to do it virtually since I don't have heaps of spare hardware, but that shouldn't be an issue, right? 

This seems to indicate that only LDAP is needed? Checking open TCP connections while attempting to use an external account, I can see an established connection on port 389 to a domain controller in their domain. Any ideas what to try? I've seen some recommendations to add the NPS server to the "RAS and IAS Servers" group, but that would seem to require a two-way trust. 

I have a server with a LSI MegaRAID 9261-8i controller. Recently I started getting alerts like this one: 

A month ago I migrated to SBS 2011 from 2003. When I decommissioned the old 2003 DC, I had it leave the domain. However, it still has a computer account in the AD. When I try to delete it I get this message (translated): 

However, name resolution works from the command line with every utility I've tried (, , ...). The server is also running a , but it seems to have been shifted over to using another name server at some point ( has the server IP listed, but commented out, and instead points at the router, which forwards to the ISP's DNS servers). Does have some internal way of doing name resolution? I have never looked at a file before today (what has been seen cannot be unseen) but couldn't make much out of it. It did not seem to mention name resolution. Any ideas what I should check? EDIT: The requested config files: : (192.168.0.25 is the server, 192.168.0.1 is the gateway/router) 

Forgive me if I'm missing something, but why are you setting up / initiating remote assistance requests from Embedded OS's? my experience with any of the Embedded / Starter version OS's everything seems like it should work normally but doesn't, typically reserve these for very light kiosk usage, and setup a third party tool like RealVNC. but it's possible there is a limiting factor here that I'm not aware of, so again apologize if there's something I'm not taking into account. 

We setup a new 64bit Print Server (Server 2008 R2) and on our previous print server we had the helpdesk as a member of the power users group, and gave them "Manager Printers" so they could change printer ports when printers went down. it looks like there was an oversight and it wasn't added when we setup the new server. I've added them to power users, and went into Print Server Properties in "PRINTMANAGEMENT.MSC" and granted the permissions, but it seems like this is only going to apply to new printers as it doesn't appear to be inheriting to any existing printers. anyway to get these permissions to propogate to the existing printers? these are setup as local printers, bound to Standard TCP / IP ports. 

I seem to have gotten it to work. I think some variable properties were sticking in memory and it was causing the query to supply the wrong timeframes. here's the finished product for anyone interested, query has been tightened up to only pull 2 sec worth of logs to parse, and only looking back the last 10 min. There's also an segment for writing the results to a custom PSobject which is useful for exporting to CSV or HTML. the only thing left is I'll insert and HTML header and have this write to a table that will come across in an email. 

are you using FQDN in your hostname, I haven't seen this specific with SQL server, but have seen it with scripted applications I've made that connect via VPN. I won't be able to connect to 

I'm preparing a quick presentation on the possibilities of Powershell management in Windows 2012R2, versus GUI-based administration. Now, I'm trying to pin down what administrative tasks typically performed using MMCs or similar are still not possible using Powershell cmdlets/functions. Some examples of functionality that is at least almost completely managable using Powershell as of 2012R2 is IIS, DHCP, Active Directory. I'm well aware that there are many additional possibilities using pre-powershell tooling, WMI, COM or the .NET assemblies, but in my experience very few sysadmins feel comfortable going there, so I'm limiting the scope to the cmdlets. 

It's been a few weeks since we upgraded to SBS 2011, and I'm trying to keep a good look at the server logs at all times. I'm alarmed however, that I get quite a lot of errors and warnings, so I've been trying to resolve the underlying problems I percieve must cause these alerts. But it seems some of them aren't really supposed to be fixed? For instance here: $URL$ Microsoft seems to recommend not doing anything about quite a few problems, 

There are plenty of google results for the same event id but different error ("access denied to Program files\Common files\Microsoft shared\Web server extensions\14\LOGS", had that error, but fixed it following the instructions given on the web), but I cannot find any reference at all to this error. Any ideas? 

I'm trying to build a single GPO which will add "Log on as a service" on all servers in a system to all accounts under the corresponding service accounts OU. So, and should be able to log in as a service on and , while and should be able to log in as a service on and . I think I should be able to do this using Item Level Targeting, but I haven't figured out how to parameterize it. Am I correct in this? And is it possible? The domain is currently 2008R2 functional level, but we should be able to raise it to 2012R2 "quite soon", if needed. 

I'm trying to make a powershell script that essentially automates the account lockout tools. ideally I'll be able to get a fairly efficient query that can identify recently locked out accounts then retrieve that data from our DC's and probably send an email letting us know who was locked out and a copy of the "message" from the security log. here's what I have so far: I read that to use Get-WinEvent we have to use a hashtable so i created a hashtable object and expanded by datetime variables into the hashtable and they appear correct, and if I run something like $hash.starttime | gm , I can confirm that it's still a system.datetime object. 

then this would just run in the background under a system account an alternative that I've seen done a lot in the past is just to create a generic login for the server / servers, then rather than logging off, just hit the "x" and disconnect the session, processes will continue to run under that user, I do this often when loading various snapshot images that take a long time to mount to a LUN, logon, click click, disconnect, check back later. 

You might have better luck pulling this out via Hardware ID, which is a lot more specific, and harder to spoof 

this is a quick way to see what users are connected to a server, this particular syntax would looks specifically for the RDP listen session on that server, once that visible it should be possible to logon, i use the command slightly differently in a script that actually crawls around 60 servers, and identifies where on the network a user is logged in. 

one consideration might be programatically dialing a VPN into these networks if it's a possibility and the client will allow it. and provided the default admin shares are enabled for logical drives on these machines you would be able to just use a UNC path to connect 

We have a multi-site domain with several sites in a hub and spoke-design. From the hub site, we have established a one-way trust to another domain though a VPN tunnel. Now, when someone from the external domain tries to authenticate, our domain controllers will return a referral to the other domain. However, the tunnel is only open for the domain controllers in the hub site. Can we somehow put use a proxy in this situation? I've been reading up on AD LDS, which comes up in searches on the topic, but it is not apparent to me how/if it would work. It seems OpenLDAP also has some proxy functionality, but I'd rather not introduce it unless it is the only option. Any other options? 

Yes. Very much so. You need to generate the key as the user you will be running the ssh client as, on the machine you will be running it from. The key is tied to that identity. As for the authorized_keys file, you need to make sure you add it to the directory specified by the sshd_config file. The default is ~/.ssh/, so look in the .ssh directory in your home on the remote computer. If there is no authorized_keys file, just create one containing the key you generated on the client. Otherwise, append it. If it still does not work, you're either not trying to authenticate with the key (more probable), or the server does not accept key login (less probable). In PuTTY, have you set the private key setting under Connection > SSH > Auth? 

I followed the technet article here: $URL$ (linked from the SBS 2003 -> 2011 migration guide). When uninstalling Exchange, I got a warning about NNTP not being found in the registry, but that didn't seem relevant, and the uninstall continued. The server was subsequently removed from the domain and shut down, as per the instructions. If I open the Public Folder Management console on the Exchange 2010 server, the public folders \NON_IPM_SUBTREE\EFORMS_REGISTRY and \Archived mails gives an error on "Update content". I haven't found anything else which indicates something is wrong. We never really used the public folders on the old server, so there isn't really anything lost. Can I just remove these folders and let them be created anew?