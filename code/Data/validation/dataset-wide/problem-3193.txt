So in summary, the Soviet "invasion", the most likely, was motivated by the defeat of Poland, absence of anything, which could somehow impede the German reach further to east and the desire to keep the German troops as far from the main Russian territory as possible. The Barbarossa plan's success could have been much likely to happen, had not Stalin "invaded" Poland. This opinion was pronounced by Winston Churchill: 

According to Russian Wikipedia, the originals of the diaries (50 notebooks, from 1882 to 1918) are stored in the State archive of the Russian Federation (fund 601), as a part of the so-called Novoromanovsky archive (i.e. the New Romanov archive). There is no mention about the Yeltsin library. 

Stalin thought that the USSR should be prepared to any war, even with Germany Stalin was planning to attack Germany Stalin was considering a war with Germany really possible in other scenarios (like German attack) 

The original words of the citation, so that anyone could check the translation even in Google translate: 

* the present-day Ukraine with people speaking similar languages This is my personal opinion as a native. I don't consider the Ukrainian language in Easter Galicia, for instance, and the one near Kharkov as the same language. And near Donetsk, for example, no variant of Ukrainian has ever be spoken by any substantial part of the people. I know, that in today's depiction of the events in the Ukraine western media show this picture: the unified people of the Ukraine stand against Russian aggression, and that they always wanted to be "free" and all this BS. But in reality the present-day Ukraine is a post-colonial state with artificial borders (the great thank you to the Bolsheviks), where even many people in the Zakarpattia Oblast (let alone Donetsk) have strong sentiments against "the Ukrainians" from the Lvov Oblast (a Wiki article about the Rusyns , not to mention the Galician/Transcarpathian schism in emigration). 

So, as one can see there was a struggle about which Ukraine was "true" and to "which one" the other parts should have been "attached". So the transition of the capital, I think, somehow additionally substantiated the claim that the real Ukraine was the Soviet one. 

I would say the end of the Khalkhin-Gol battle and the Soviet entry into former Poland's territories was just a coincidence. Why? There was nothing to influence on September, 17th, 1939 except the German troops' proximity to Moscow, since Poland had been already defeated I know, in present day Poland's historiography there are widely accepted statements, that Poland was defeated by the double assault from Germany and the USSR. And had it not been a Soviet "invasion", Poland would have successfully repealed the German assault, since the Germans were starting to experience fuel shortages etc. (this particular "theory" was promoted by Polish historians according to Suvorov-Rezun, he mentioned this in one of his works), but these "theories" are questionable at the very least. There was no functional government in Poland on Sep. 17th, an assertion which can be found in various sources like Tippelskirch's History of WW2 (in Russian), who stated that the government fled on Sep. 16th or Liddell Hart, who stated it fled on Sep. 18th., other authors (like Kacewicz G.) provided Sep. 17th as the date. For me it makes not much difference whether the Polish government was in Romania already at Sep. 17th or it was somewhere on the Romanian border ready to flee the next day. The most astonishing thing about the "existence" of the Polish government on September, 17th is the anecdotal story about how the Soviets notified the Polish government about the necessity to enter the former Polish territory. The Polish ambassador to Moscow Wacław Grzybowski refused to contact the Polish government on a request of Soviet Vice Foreign Minister Potemkin (in Russian, an extraction from the official journal of Vice People's Commissar of Foreign Affairs Potemkin regarding a discourse with Polish ambassador Grzybowski, sent to General Secretary of the VKP(b) Stalin, Sep. 17th, 1939): 

I suppose this corroborates the opinion that there usually were no leisure sun-basking or fresh air breathing sessions on the deck. And this was true even for subs, which patrolled Japan's coast and were based at Pearl Harbor, even during their voyage from Hawaii to Japan and back, because of many dangers: enemy surface ships, submarines, but especially aircraft, as Holmes describes: 

I think, this answers the question to a certain extent. I cannot recall now an example pertaining to other periods of the war (the one provided describes only its initial stage), but I don't think that instructions regarding "strangers" on the deck could have changed significantly. 

* If anyone needs a direct reference to the citation, one can search the book "Великий главнокомандующий И.В. Сталин" for the words "пожалуй, наибольшей подлостью Г.К. Жукова явилось", I cannot provide a page number, since I have an e-book edition. 

These are only few, the most public and sort of famous. If I recall anyone else I'll edit the answer to add them to the list. If you was asking about the Soviet era too, than I can name, at least, Yuri Andropov, who had been a diplomat and the Party officer (almost 100% sure that he had direct relation to secret services) before he became the General Secretary of the Party — de-facto and it might be de-jure the head of state in the USSR, I'm not an expert in the Soviet Constitution. 

Point 1, Stalin thought that the USSR should be prepared to any war This one is trivial, since it's obvious that any normal government should be always prepared for war and there are always numerous documentary evidence of this. Point 2, Stalin was planning to attack Germany Regarding this, I can say that there is no such known documentary evidence, but with two important reservations: 

This is the first time I heard this, though I'm generally interested in Russian history, so I am not claiming any authority in my answer. I posted this query in Russian into Google and it returned a list where I have not found any serious mention of this matter. No historical papers, no textbooks, only some blogs, political sites etc. I searched for all occurrences of the word "helmet" in volume 1 of the Cambridge history of Russia, and have found no mentions of this helmet, though there were no mentions of any Alexander Nevsky's helmet (the search has found about a dozen of occurrences, so I am pretty sure, that I did not miss any). So I think that this is sort of political propaganda. 

First, your question is not completely clear. What do the words "prepared to fight Germany" mean? There are three options here: 

Point 3, Stalin was considering a war with Germany really possible This is directly related to questions "did Stalin really ignore numerous evidence of German war preparations, intelligence reports about them", was he "mentally broken down" and all this stuff. To address this point one can write a book, so I will give only a couple of instances, which debunk many or at least some of those myths about Stalin and his behavior on the eve of the war. The most concrete evidence of the fact, that Stalin planned to fight Germany is the order of military alert (I don't know if this is a correct translation of the Russian term "Приказ о приведении войск в боевую готовность"), which was given on June 18th, 1941 (the order itself most likely was given by Zhukov or Timoshenko, since they were respectively the chief of the General Staff and the People's Commissar (Minister) of Defense at the time, and Stalin had no office in the the Army until July 19th, 1941). The document itself today may not exist, since it was probably destroyed during the Khrushchev times. Why it was destroyed is another question but this was definitely a part of the anti-Stalin campaign in the USSR during Khrushchev's rule. But there are numerous other documents, which mention that order. I'll give a citation from the book of a Russian "amateur" historian Yury Mukhin "Great commander in chief J.V. Stalin" with my translation* and my notes in square brackets. Some may consider Mukhin an odious person, but I mention him here only as a tribute to his findings and work, I'll give references to "serious" sources corroborating Muhin's points as well. At least, unlike Suvorov, Mukhin has never been caught with falsification of citations. 

Regarding life of board a submarine, there are several other excerpts, which touch many aspects, but no one mentions any crew members on the deck "to stretch their legs and get some fresh air", as was asked in the referenced question: 

Long ago I read a book "Undersea Victory: The Influence of Submarine Operations on the War in the Pacific" by Wilfred J. Holmes, but it was in Russian translation and I'm unable to find its available English version now. So there may be some discrepancies because of re-translation. The author himself was a pretty distinguished submarine officer of the US Navy, with enough authority to regard his opinion as significant. In the book there are first two chapters, which were written in style of novel and cover the first missions of the USS Gudgeon and USS S-38 in December 1941-January 1942, and they give some impression about everyday life on board of a submarine during the war, while the submarine was on a combat mission. I don't remember all the details in the book, but there are some quotations I was able to find in a minute, which pertain to the subject (note, this is a re-translation from Russian): 

It's hard to answer this question with provision of sources. I studied history in the Ukraine, and I cannot remember that this question was payed more attention than just "the capital was moved in 1934". As a theory I can suggest, that this definitely was not "accidental", this decision had substantial reasons, and it was related to the hype about the so-called "Ukrainian question" before WW2. Before WW2, territories of the present-day Ukraine with people speaking similar languages* were divided between the USSR, Poland, Czech-Slovakia, Hungary, Romania. And with the accession to power in Germany of Adolf Hitler and his party, with their claims for Lebensraum at east, this "Ukrainian question" gained traction in the international affairs. There were numerous claims outside the USSR, that there had to be created "the Great Ukraine" (by taking its main part from the USSR) and so on. This was augmented by various terrorist activities of Ukrainian "nationalists", supported by Germany, not only in the USSR, but in Poland also. Long story short, the was a struggle going between various powers in Europe for territories of the present-day Ukraine. This struggle had a necessary ideological part: the German Nazis and their Ukrainian ideological brothers had claims, that the Ukraine was being occupied by Communist Russia, and the fact that the capital of the Soviet Ukraine was elsewhere, not in Kiev, the city which historically (since the second half of the 19th century, when all this Ukrainian nationalism started with support of Germany and Austria-Hungary) was considered the center of the Ukraine and without any doubt was definitely the most important city on the territories in question, that fact of the capital not being situated in Kiev was not in support of the Bolshevik's claims, that the true Ukraine was the Soviet Ukraine, because it even had a different capital from "the true" one. There might have been a chance, that the transition of the capital in 1934 was related to the more significant control of the area by the Bolsheviks in 1934, in comparison to, for instance, 1919, (this is not a trivial question, because the position of the capital, especially in a such "big-government" state, as the USSR and its republics were, the capital situation has a direct relation on which side the government employees' sympathies, loyalty etc. would be and so on) but I don't think so. It looks, that the main reason of the transition was the galvanization of "the Great Ukraine" theme in the West since 1933 and the Soviet desire to buttress their claim of "the true" Ukraine. And in order to show some grounds for my opinion, I would like to give an excerpt from a Ukrainian history text-book of 2006, by O. Boyko, in my translation (the text-book itself, the excerpt's original should be searched by the words "Ініціатором рішучих дій у вирішенні українського питання напередодні", because the pages in the file have no appropriate numbering):