I am trying to troubleshoot mirroring issue where we are getting threshold exceeded for unrestored log too high on mirror server. On the mirror server we have database snapshot created for the database participating in database mirroring . Now for past week we are observing that counter high redo queue goes on increasing rapidly to 30-40 GB and after 4-5 hours start normalizing. While troubleshooting i came to know that users are querying on snapshot database. Many of them running for last 2-3 hours and some for hour and some for mins. But i have seen queries which are running for over 5 hours kept running and this redo queue starts lowering down may be because of other queries getting completed. How can i identify or troubleshoot further to find that culprit set of queries which are actually causing unrestored log to go that high Update@ Database mirroring is in SYNC mode 

As a best practice, i am trying to schedule an activity where all SQL agent jobs should log output to text file. Manually i can do this for single job. But i am looking for a better way either by script or any good method i can make this change for multiple jobs about 80-90 jobs per server. Moreover i have to do this in QA, UAT and prod, covering over 100 servers. Please share you're experience or any helpful links how can this be achieved in best way as path of log files where output will be generated should be common across servers/jobs. 

Please advise how can I arrange them or what should be the guidelines to make a better indexes before dropping them. 

I have a database of size 840 GB which has 948 VLF's. On other hand there is one with size of 1.6 TB having 320 VLF's. Does that indicate the smaller database with that high count of VLF's is actually a problem? Also how can we decide that number to be too big or within OK range. Please suggest 

We have set up LS to do cutover from standalone SQL server 2012 to clustered 2012 servers. The primary database where we have set up LS is also involved in database mirroring and is about 1.8 TB in size. This is PERF env to test the actual cutover and transactions are not frequent on database where LS is set up. Issue: I see that LS backup job on primary runs longer than scheduled [every 15 mins] or fails with below error: 

Before proceeding, I know the cons of doing this and have read many questions on same. But since we are here on urgent need and adding disk would take over a couple of days and the DB in question being not that critical, so is there a way I can release the unused space from database. Below screenshot says unused space as 36 GB, but when I execute sp_spaceused it says unused as some 400 MB but unallocated much more. 

Even though, I've searched couple of them online but still looking if there is a better way to manage the SQL server backups, almost across 250 servers. Issue is we are not allowed sysadmin login to be created on one server to pull this report from. Please suggest a link or way to view the health report for sql server backups. Also SSRS works as we are not supposed to use database mail to sen emails 

I am trying to gather some stats on comparison of run time vs performance between Litespeed backups and sql native backups. As we are no longer going to use Lite Speed [even though i personally loved that SW], have to gather metrics how SQL will perform using native compression backup] So i am looking for a way to reduce CPU usage to X % while taking native compression backups. In Litespeed we just specified this option in advanced tabs and saw everything running fine. I am aware of resource governor, but due to some constraints not able to use it. Will need to work on that. But is there a better and smarter way to do this. Please suggest Edit.. Have to add, as per security and company policies we cannot use third party or external SP's to be created. I saw this can be achieved using OLa 's script as well, but we wont get approvals to introduce this :( 

I am trying to find out the queries which would have run and caused bloat to TempDB. I am able to pull data like TempDB bloating on one particular day where it almost ate upto 300 GB of space, was somewhere in middle of last week. As per post How to find the SQL statements that caused tempdb growth?, i can find below data but not sure how to interpret this as i can find host and login, but not the actual queries. 

There is no fixed pattern when its failing. generally it completes in 18-20secs but on some runs it fails when running over 50 mins or so. How can i troubleshoot this further? Edit: @ Log backups are from 100-200 MB generally every 15 mins 

I am confused or do not have better understanding on how SQL works in below scenario and need some views: For a database X, we have a FILEGROUP named FG which has 4 data files tagged to it as below 

I would need some practical suggestions on how to achieve below: We have quite a few servers involved in database mirroring. As part of various activities and other fixes, we have database failover happening now and then. What i am generally doing is browsing the sql error log to find the failover details for most of them Is there a way , we can store or track the failover details for them either locally on server, say saving all that details in a text file or on repository server? Thanks 

Apart from above we have PRIMARY FG with mdf data file set to unrestricted growth. All are set to auto grow by 10 GB Now, i see alert for Filegroup FG being FULL and rebuild index job failing with same saying "could not allocate space for object within the table tb1 for the database above because the Filegroup is FULL" But if i see from above data files tagged to FG, we still have 70 GB left, then how come its failing ? Please suggest how SQL works here in allocating new data for case above? Edit 

Experts, Need to know if anyone has witnessed or found such settings while patching SQL servers for Meltdown patches. Our sys admins informed that OS patches for Meltdown can be turned ON/OFF bases on registry setting and can be enabled or disabled. Just looking if someone know a similar way available for SQL server patches? Means you can turn it active when needed? 

only 1 index that is clustered name rows reserved data index_size unused tb1 433785377 445952328 KB 444075128 KB 1800504 KB 76696 KB 

I have no clue if this points any issue with stoage. Now the concern is, before we did migration i had similar error messages on the this instance but they were like coming after half hour 2 hours or may 15mins. no fixed pattern. But after migration above error message keeps coming every 2 mins from the day we migrated. That is what sounds alarming. On the old server from where we migrated, yes we had similar messages but again there was no fixed patterm, sometimes 2 mins, an hour may be after 4 hours, but not continuous like on new server. I got some info here $URL$ But still i am confused how to deal with this and what exactly these messages point dba's to look for? Please suggest 

Due to lack of my knowledge in service broker i am finding hard time in troubleshooting Service broker in one of the databases. 

I am seeing below error messages when we have moved/migrated databases to new server/instances from SQL2K12 stanadlone to cluster 

Initially the Service broker somehow got disabled on this database running ssis packages using conversations to process messages. Still wandering how it got disabled and not getting enough info to find. please suggest where to look when i enabled it using , it enabled SB but seems to have clear of the messages i see in . But the issue is i dont see those messages coming or starting. so i am back to my original issue of service broker not working. How can i troubleshoot and get this working 

I ran a script to find overlapped and duplicate indexes for a database. Below is the sample screen for the above said. 

This might be a simple one, but i searched a lot and unable to find one. Is there a sql query or a way i can run on registered server to find the list of all sql related services running like, ssis , ssas, ssrs, sql, agent, broswer, etc... Tried googling out and can find sys.dm_server_services dmv but it does not show all the services running 

I need your help in understanding/resolving one of the issues we are witnessing today. We have a high value of unrestored log on secondary side where value keep ranging from 5-10 GB as monitored. Simultaneously we have a job to create snapshot on this mirror [for reporting] server every 30 minutes which completes within a minute when unrestored is within MB's but keep running for 2-3 hours with high value of unrestored log The database here is 10 TB and OLTP with DB in high PERformance mode. Could someone explain why the snapshot job is running that long or how to find it and fix high unrestored value? Or could it be Vice-versa and i am thinking wrong as mirror causing snapshot to run that long? 

We have a need where we need to set up LS for the servers where we use NAS for backups. As NAS is shared between Primary and Secondary there will not be a need to use LS COpy job as backups will be duplicated and LS might not work How can i set up with just LS backup and LS restore configured and make LS a success? 

I am trying to figure this out and seems to be out of thoughts and need your inputs to help me figure out on this. We have implemented SSL across our 200+ servers, SQL2012 & 2014. These cert are valid for 9 months . These are from vendor symantec. Now the problem is tracking when they get expired. Keeping a manual track of these many servers are tedious. Is there a way we can pull this up from SQL to get the information and create an SSRS report to check when they are going to expire? 

Apart from above we have PRIMARY FG with mdf data file set to unrestricted growth. All are set to auto grow by 10 GB Now, i see alert for Filegroup FG being FULL and rebuild index job failing with same saying "could not allocate space for object within the table tb1 for the database above because the Filegroup is FULL" But if i see from above data files tagged to FG, we still have 70 GB left, then how come its failing ? Please suggest how SQL works here in allocating new data for case above? Edit