I'm running two Nexus 3048 switches as network core and I got an issue when linking another switch (specifically a 2960-X) on the vPC links. Consider the scenario: 

On the 2960X there's a Port-Channel configured in active mode. When setting the interfaces on nexus as: , Bridge Assurance comes in action and blocks the ports. At this moment I'm running it on "normal type" so it won't disable the links. I've read something over the web that I can't use but I don't know if my mind is playing on me or if it's exactly the case. If yes, why I can't do this? Network ports shouldn't be used for inter switch connections? Thanks, Additional Configurations for the exemplify the issue: NX #1 

If you just plug it on the network without touching anything on the configuration it should behave just like an unmanaged switch. This happens because the stock configuration generally allows this. If the switch have VLAN capabilities it come for example with a predefined VLAN1. But do yourself a favor and at least learn how to connect to it and explore its features. If you like networking you'll be pleased. 

We're building a new core for our University and one thing that bugs me is the iSCSI network. We already considered Jumbo Frames and Flow Control on the iSCSI ports, but one thing remains for debate, and it's the QoS Feature. Our new core consist of two Cisco Nexus 3048. There will be two different iSCSI VLAN's for MPIO, one VLAN will be in the first switch and the other one on the the second. The Jumbo Frames and Flow Control seems trivial, but QoS does not appear to be simple. I was unable to find any guidelines for iSCSI on the Nexus 3048 models. There are a lot of information for the 5000 and 7000 series but many features are missing on the 3000 series, like the QoS traffic match with the iSCSI protocol. Another thing that I'm unsure is about CoS (Class of Service) Classification. Is this a requirement requirement? I don't know where iSCSI should be placed. Thanks in advance, V. EDIT with Answers: 

If you have the conflict resolution configuration in place, the device will chack if the IP address is already assigned to another client or not. Also, If the clients are already assigned an IP and the DHCP for some reason stops, the client will continue to communicate normally before the renew period expires. So in case you reconfiguration affects the DHCP, you clients that already have an IP will not be affected. The new ones will get the IP from the new pool after the conflict test is passed. However, if your setup is critical, I strongly advise you to do a test of this scenarion on a spare router before implementing it on a live system. Also try to find a low traffic period for your change. 

LAN1 (source:192.168.2.100, destination:192.168.202.100) -------> LAN1 Gateway Router which will do NATing and VPN. (change source:192.168.102.100,destination:192.168.202.100) ---------------> LAN2 Gateway Router which will terminate VPN and do NATing (source:192.168.102.100,change destination:192.168.2.100) ------------------------------------------------------> Packet reaches LAN2. 

As you can see, LAN1 appears to LAN2 as 192.168.102.0/24 and LAN2 appears to LAN1 as 192.168.202.0/24. 

Concepts: VLAN: a logical separation of networked devices (Different IP address ranges as well) on the same switch or multiple switches such that users of one VLAN can not communicate with the users of other VLANs unless there is a router (a layer 3 device) that routes the traffic between them. A trunk link: a network link that carries more than one VLAN. The traffic of each VLAN is marked so the other end knows what traffic goes in which VLAN. If the other end is a device that only needs one VLAN, it will take the relevant traffic and ignore the traffic. Router on a stick: It is a layer 3 device capable of routing traffic between different VLANs but it has only one physical link. The traffic comes to the router in a trunk on the link and gets routed from one VLAN to other on the same link. UTM: Unified Threat Management box that provides firewall, routing, authentication, anti-malware, web filtering, guest user authentication and more. Your basic requirements are: 

In all cases DHCP still does not work. But there's connectivity, because I can set manual IP addresses in all cases, and everything works as it should. Orphaned ports, trunked ports, port channels, etc. So it's definitely something on the switch dropping the DHCP packets. There's no DHCP features enabled on Nexus, sÃ³ it can't be any security problem: 

I've a strange problem with a pair of Nexus 3048 Switches in a vPC configuration. Since the core are still under implementation we've hit an strange issue: clients can't get IP addresses from the DHCP server, but the SVI can get an address from the DHCP server. The DHCP server is plugged on another switch, but the connection is made on one interface on the first Nexus and the interface have this configuration: 

On the 3COM switch there are rules for DHCP relaying from different subnets, configured in the following way: 

A couple of design questions: - Are you mixing iSCSI and other data in this cluster (I assume you will user VPC)? - Are you mixing iSCSI and other data in the same port with tagged frames? 

This is really frustrating, since DHCP is dead simple and it should work without any hassle. The DHCP server in question is the isc-dhcpd-server running on Debian 7 Wheezy and it's on production, serving a lot of different subnets, so it's working as it should. What I'm missing? There's something that should be enabled on Nexus? Perhaps some kind of default ACL's blocking the DHCP traffic? To be more precise here's a drawing of the topology: 

ARP tables are populated when the machine sends any traffic to the network (DHCP or any other). The switch receives the packets generated by the machine and grabs the mac address of the machine and puts in ARP table with the information of the port it came from. So, if you can't see the ARP entry of the laptop, it means that the laptop did not exchange any packets with switch. A note, there are two commands for arp: and . 

LAN2 (source:192.168.2.100, destination:192.168.102.100) ------> LAN2 Gateway Router which will do NATing and VPN. (change source:192.168.202.100,destination:192.168.102.100) --------------> LAN1 Gateway Router which will terminate VPN and do NATing (source:192.168.202.100,change destination:192.168.2.100) -----------------------------------------------------> Packet reaches LAN1. 

You will need double NATing to achieve this without changing IP addresses. You can not ping an IP that is in your LAN and expect it to reach somewhere else. As long as you are part of a LAN and communicate locally, your traffic to IP address in 192.168.2.0/24 will always go to your local network. As mentioned above, you will need two IP ranges lets say 192.168.102.0/24 and 192.168.202 that will be used for double NATing like this: 

There is an option to resolve IP conflicts between clients on Cisco IOS. It needs to be configured carefully. from this source: 

The selection criteria between the two choices needs to be refined further in your question. If all you care about the throughput on the switch and ignore all other things, you can go with the device that provides more throughput. 4500 switch is a layer 3 switch used for access or distribution (even core for small networks) with huge capabilities and flexibility. It is a modular switch meaning that you add modules based on your needs. For sure it will be more expensive and might be an over kill for your needs if all you need is to add a few servers to your network. Buying the 2960S stackable switch on the other hand will be cheaper as it is a layer 2 switch used only for access layer. You can always always buy more switches add stack them together if you need to add more servers. Please keep in mind that your server performance is not only governed by the access layer switch you will buying. It will depend on the complete path your user data traverses before reaching your servers. 

What is the actual issue you are experiencing? Is this a performance problem? Generally, it is not advised to have your ISCSI network on the same hardware that will provide connectivity to the rest of your network. You should really be using a dedicated switch (2 for redundency) for your ISCSI network and segrate that from the normal user data. 

There's no Layer 3 routing happening inside the Nexus. It's plain Layer 2 networking, which should work without any hassle. The curious thing is that the SVI can get the IP address from the DHCP server. The same SVI on the second Nexus cant't get the address either. I've done the following tests to debug the problem: 

I've a pair of Nexus 3048 running NXOS version 7.0(3)I2(2d) and I can't enable flow control on ethernet interfaces. When issuing the command: it returns with: 

I have figured out. After four working days wasted, it was a bug on the NX-OS firmware 7.0(3)I2(2d). After upgrading to the latest recommended version 7.0(3)I4(6) the DHCP packets started flowing normally. Here's the link to the Cisco website: $URL$ 

Everything is working on the DHCP relay side, since anything connected to the Vlan-interface 37 works as expected, doesn't matter if it's a random host of a switch with others hosts attached. And finally here is the full Nexus #01 configuration. The second one have similar configuration. 

I even used tried on client machines to see if the DHCP packages are sent and I can confirm they are being sent. On the switches I tried some debugging with and what I see is a lot of "DHCP Discover" requests without any answer. Only the SVI DHCP request of the first switch appears to be working. Here is a snippet: