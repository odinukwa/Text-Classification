i'm running a hostgator vps php/apache/linux/mysql i have a problem that i cannot seem to properly diagnose/fix : 

Set old IP as "permitted sender of" mysite.com and send emails from new IP to old IP via authenticated SMTP The good : mail passes SPF and appears as being sent from old IP, nothing specific running on old IP except mail server. the bad : mail does not pas DKIM, and sending from new IP -> old IP -> the world via SMTP is extremely extremely slow. I send 60k+ per day. 

Set old IP as "permitted sender of" mysite.com and send emails from new IP -> old IP via remote SQL. Old IP then crons over any emails in the SQL and sends them out. The good : mail passes SPF and appears as being sent from old IP. Faster than solution A. the bad : mail does not pas DKIM, setup is a bit of a hack and not very maintainable. 

Move site to new host/IP continue sending site's mail from old IP build up sending reputation of new IP : gradually increase amount of mail sent from new IP, while reducing mail sent from old IP I would like my mail sent from both old and new IP to both be SPF and DKIM signed, and both appear as from noreply@mysite.com and return to bounce@mysite.com 

I have spent the last couple of days going through SO questions and the Postfix documentation but have not succeeded in figuring out what I'm doing wrong. My situation is as follows: 

Running websites sandboxed is always a good idea. But an important question that you need to ask is - are you & your clients willing to take the performance hit that comes from implementing suexec/suPHP? I can't find a more recent article, but this 2007 post benchmarking suexec says it's about 30x slower than regular mod_php. If your clients are running in mixed technology stacks (for ex., Perl & PHP are both required) you might want to consider the peruser MPM instead. The peruser MPM isn't part of the core Apache codebase, but it's listed on the official Apache wiki which would seem to suggest that the Apache foundation believes that this MPM development isn't going to disappear overnight. Now if your clients are running just a regular LAMP stack (emphasis on the P) - you might want to look into PHP-FPM instead. It's a PHP-CGI implementation that provides native sandboxing, chrooting and many other customizations not offered by native PHP-CGI+suPHP. Plus, from PHP 5.3.3 PHP-FPM is part of the core PHP stack so you don't need to worry about compatibility issues. 

I'm quite sure this is a server-side issue but have no idea where to start looking, any pointers much appreciated. i can attach any logs or config files that could help. 

It occurs mainly on pages where file (image) uploads are done. It then causes a 500 error. Google hasn't returned anything conclusive, has anybody come across these errors ? 

I've come across several IPs that are marked as belonging to RIM/Blackberry but seem to be a source of spam/fake users to our sites, examples : $URL$ $URL$ Normally we this this warning ("recently reported spam source") with tor nodes and such, but how can spam be coming from the RIM network ? 

sometimes when loading a page, the browser will load have the page, then it hangs for 10-15s, sometimes more, then load the rest of the page if during the hang, i refresh the page, it loads quickly there is no abnormal load either on apache or sql, no broken links, bad javascript or so 

I am getting these errors on some pages in my site (php/apache/linux/mysql vps) on intervals and can't seem to find any reproducible scenario : 

From this test, I can see that the canonical mapping isn't the issue. The rewrite is happening correctly. However, Postfix seems to not recognize the output as a valid email address and appends the FQDN which causes the relaying to break. 

Why is Sender address set to post=DomainB.name@DomainA.com even though Postfix has been set as: append_at_myorigin = no append_dot_mydomain = no Due to Sender address having DomainA.com appended to it, it seems like Postfix chose to relay mail using SASL details for DomainA - confirmed by reviewing logs on MailGun dashboard. This is causing the bounce address to be set to DomainA as well. 

I have setup a Proxmox Host on OVM Hardware and am giving the guest VM's Internet access using the Bridged setup. However, as this requires editing configuration files on the Guest to work correctly, there are errors during the actual installation process resulting in issues like no interfaces files being created or resolv.conf missing. I am trying to workaround this by adding a NAT-based interface during the Guest install. However, I am having problems where the Guest VM's can reach external servers by IP but not by name. This is the network config on the Host: 

I run a reasonably busy (700,000 page views/day, php/mysql) site that gets steady traffic (normally no spikes). The last two days, around peak usage time, and for about an hour, my site had suddenly gone from being very fast to unresponsive, for about an hour, and then back to being super fast. The CPU load jumps dramatically at 2:10AM : 

I'm really not sure where to start investigating this issue. I'd appreciate any pointers with : 1 - how to fully diagnose this issue now 2 - or what tools to install/ commands to run to capture extra data when it happens again. thanks in advance. 

Hosting company tracked it down to an apache misconfiguration, they increased the memory limits for apache and problem is now resolved. 

No, i cannot keep the old IP Both servers are whm/cpanel based (which I am more comfortable with) Site is php/mysql5.1 

Doing a google for "Research In Motion UK Limited recently reported spam source" returns tons of results of people complaining about dating/romance scammers using similar IPs. Obviously not an isolated issue with me. I have sent to RIM about the IPs I have, but this seems to be a rather bigger issue than a few IPs. So much for RIM being the "secure one". 

Kloxo had major vulnerabilities exposed last year, which resulted in a very personal tragedy - the then developer of Kloxo/HyperVM took his own life. Since then, the product has been open-sourced and a check of the forums suggests that the major vulnerabilities have in fact been fixed. After that particular incident however, I'm very wary of using Kloxo so I'd recommend looking at other options such as Cpanel (if available) for providing a Web-based administrative interface. If you are limited to using Kloxo, I'd suggest starting off by looking at the Security sub-forum on LxCenter and articles like this on the LxWiki. 

Since you are running a VPS, you are likely not running X-Windows by default. On Debian, installing the freenx-server package will install X-Windows and provide you with a secure way to connect to the remote GUI. After that, you can use any of the GUI-based FTP clients that @Ignacio mentions. 

Restart SSHD while still logged in for the changes to take effect, then log-off. The next time you are able to successfully SSH into your server, post the output of /var/log/secure. Also if you have acccess to a Linux client machine, try logging into your server using the following command: 

Problem turned out to be a misbehaving cpanel system cron job that was using up all the CPU, in turn causing apache to be unable to serve requests. 

Hello I'm in the process of moving my site to a new host (ie new IP). I run a social site that sends a large volume of (valid) email, and I have built up a good sending reputation with my current IP over the last 2 years. My migration plan generally is : 

I have a VPS with 768 MB RAM and a 1.13 GHZ processor. I run a php/mysql dating site and the performance is excellent and server load is generally very low. Sometimes I place ads on Facebook and at peak times I can get 100-150 clicks within a few seconds - this causes the server to run out of memory : Cannot allocate memory: couldn't create child process: /opt/suphp/sbin/suphp .... And all users receive an error 500 page. I am just wondering if this sounds reasonable or not - to me 100-150 does not seem to be a number that should cause apache to run out of memory. Any advice/recommendations how to diagnose the issue highly appreciated. 

That would help in figuring out what the client sees when the server is "hung". One other tip - I notice that you have PermitRootLogin set to "Yes". On a public-facing VPS, this is a a very bad idea. Please set it to "No" and use sudo instead. 

Something like what you are asking for is possible with Nagios & NRPE. This article has a introduction to NRPE and here's another article that talks about restarting services using NRPE - something that can be pretty easily extended to rebooting the monitored instance itself. Since all your machines have public IPs, you can setup SSH tunnels on your Nagios-Master to the SNMP interface on your Nagios-slaves which takes care of the security aspect. 

When you are able to successfully log into SSH, try this - change the LogLevel in your sshd_config to read: 

Try #2 of canoncial_maps- only email addresses ending with DomainB.com are re-written to email@DomainB.com 

In trying to get the DNS working, I have added a number of rules to iptables. Here's the iptables output from the Host machine: