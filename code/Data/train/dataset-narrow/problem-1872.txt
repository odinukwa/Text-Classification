That will give you the corresponding value in B2:B6 for the 2nd row with "Apple" in A2:A6 - there's no need to look at A2:C6 when the fruits are only within the first column - this is an "array formula" which needs to be confirmed with 

If you just want to count the different order numbers (in column B) that are complete (column A) try this 

There are two possible ways: 1) format your cells as text before input 2) use an apostrophe to precede the entry, e.g. enter '01-00 - the apostrophe tells excel that the entry is to be treated as text - it isn't displayed 

You can simply reference B13 in a conditional formatting formula for B2, e.g. select B2 and then use a formula like 

Based on my answer to your previous question here this just adds an additional complexity but you can essentially do the same, e.g. with 

So is the idea to return all the values from AB193 until the last non-blank value? If so try using like this 

Here's one way to get a new column of weekly dates in P2 down based on the bi-weekly dates you already have in I2 down Put this formula in P2 

In you can use function for summing with multiple conditions. That's preferable, because it's simpler and faster and doesn't need "array entry". Try this version - 

If you have valid dates in then you can just use function in , e.g. to count November dates you can use this formula 

In a word - "No" Excel has no built-in worksheet function that concatenates a range - MCONCAT function from MOREFUNC add-in could do that but I'm not sure the add-in is available any more, otherwise you need VBA or a UDF.....or continue with your workaround 

Note: this finds the last value "positionally" - assuming your dates are sorted in ascending order as per your example that will be the same as the last value chronologically 

That latter process should only be required, though, when converting dates from an unrecognised format for your region 

You can use INDEX and MATCH with the rows offset by 2 or whatever number you need, e.g. for your example 

for multi-cell formulas these are formulas that return an "array" of values, e.g. this formula returns as "array" of 21 values 

If you want to do this with a single formula it becomes a bit of a monster.....but you can use this array formula in copied down 

and then click "Format" button to set required format (red fill) That will then highlight any "A" entry in column B where column A in same row = "C" Instructions apply to Excel 2007 or later 

If column I last value is always text then you could use LOOKUP to get the last text value in that column 

Don't you need the result to be 24%, 20% or 16%? If so then you have the wrong start point for OFFSET, try 

No, you can't use AND or OR in this way because those functions return a single result rather than an array. You need to use * instead of AND....or multiple IFs, e.g. either 

If you still get errors then perhaps you have errors in the data range . If so then an alternative approach is to subtract one function from another. That helps because will ignore errors in the data, formula would be 

....although that falls over if you have punctuation like _ or . in TITLE.....but you can use any number of functions to replace those with spaces like this 

Try creating a "Dynamic named range". If you have continuous numeric data from A8 downwards then that can be defined as 

That would mean that 5 isn't found, 6 is found in the 4th row of the lookup range and 7 is found in the 11th row. The function, therefore looks like this: 

NETWORKDAYS accepts "arrays" but not ranges (in Excel 2007 or later) so the +0 converts the range to an array instead of means you don't need to "array enter" the formula If you use then you "array enter" by doing this: 1) Select cell with formula 2) Press F2 key to select formula 3) Hold down CTRL and SHIFT keys and press ENTER if done correctly you get { and } around formula 

COUNT counts numbers so you only get a sum if that count is > 0, otherwise you get a blank use your actual range in place of "Range" 

that will also count any blank rows (as does Andi's) so if you want to avoid that change to this version: 

to find the maximum value in A2, E2, I2 and M2 and then the header in row 1 for the matching column you could use this formula 

If you want a formula approach then it's much simpler to get the results in separate cells, so lets assume that your first table is A2:B8 and the colours are listed again in D2:D5. Try this formula in E2 

Try using to test whether the cells are populated or not, e.g. if you want the formula to return a blank only if neither cell is populated 

The rule is that you need to apply the formula that applies to the top left cell of the range - Excel will automatically adjust the formula for the result of the range, as if the formula was being copied down the worksheet, so if you select a range like you can then apply the formula that would be correct for , i.e. 

Note that all entries are errors except for 17 at position 8 (17 is the position of the "A" of "AUG" in B2&" "&C2). When function (with no 3rd argument) looks up a "bignum" like 2^15 in that array it always matches with the last number so the result is 8 (because "aug" is 8th in the list of months) 

that works because if the A2 time is before 1:00 the B5 time/date has to be at least 5:00 the following day....but if A2 time is later then it's 24 hours later. Note: I'm assuming that you need to full consecutive periods (not some partial periods that would add up to 8 hours between those times) Edit:....or even simpler version 

confirmed with CTRL+SHIFT+ENTER That gives you an actual % like 0.5 - if you want 50 multiply by 100 

If you get it's a valid date - if you get it's not This works because in Excel real dates are simply formatted numbers For a range of dates you could also use function which only counts numbers, so if you have fully populated range of dates in then if they are all text formatted the following formula will yield a result of zero 

Assuming there are actual dates in cells we could convert them all to a specific year (1900) and then average, so...... 

.....but if they are true dates you'd get a count of those, i.e. If you have "dates" that look like dates in a valid format for your region then it should be possible to convert them all to dates in one step using "Text to columns" functionality 

I tried your formula in Excel 2003 and it works for me - and are built-in functions in Excel 2003 but is part of add-in - if you don't have that add-in installed then you will probably get a #VALUE! error. Try enabling Analysis ToolPak Tools > add-ins > tick "Analysis ToolPak" box. You may need to re-enter the formula. If that doesn't work or if you don't want to or can't install add-ins then you can get the date from 12 months back with this formula 

Note: Sum range is always at the start in ......and I changed one of your ranges because it ended at row rather than like the others, all ranges need to be the same size and shape in 

If you only have spaces between words you can search for the word with spaces either side to avoid partial matches, e.g. 

Two possible approaches 1.Create the formula as a text value and then convert to a real formula, e.g. put this formula in B1 and copy down as far as you need 

I suspect the formula used involves adding 24 when end time is smaller than start time (to account for the extra day when passing midnight), e.g. something like this: 

There's a function which is part of add-in - but you'd need the add-in installed and it only allows you one condition and you appear to have two - try using 2 COUNTIFS functions added together. 

custom format results as [h]:mm then you can simply average the result column Note: the formula works assuming that A3 and/or H3 are always weekdays Alternative solution: Use this formula to fix the problem I identified 

I'd advise you, if possible, to put the two time values in separate cells, e.g. 09:00 in A2 and 10:30 in B2 then use this formula in C2 

Here are two possible formula approaches - if the "valid tokens" are shown (one each) in cells Summary!A30:A32 then you can use this version 

That uses to replace each colon with 100 spaces. As we are dealing with IP addresses each part is clearly a small number of characters so then using to take 100 characters starting at char 300 will include only the last part of the IP address and some spaces - then trims the spaces - I used the same approach to get the middle two parts and then function combined with to get the first part 

then FALSE values return FALSE.....which is ignored by SMALL anyway ...so a better formula would be something like this: 

confirm with CTRL+SHIFT+CTRL and copy down - change the range in the functions to match the cell above your start cell. Note: - you don't need a column of random numbers with this method 

Excel can handle negative times......but only if you use "1904 date system", rather than Excel's default 1900 date system To set that for a specific workbook do the following: File > Options > Advanced > Scroll down to the "When calculating this workbook" section (towards the bottom) and tick the box for "1904 date system". Sometimes you may get undesirable effects. Don't switch to 1904 date system in a workbook where you already have dates - because the base date is rather than the dates will alter by 4 years and a day (1462 days). See screenshot: 

For substrings within a date range you can use COUNTIFS (with an "S" on the end) with wildcards, e.g. 

function allows you to separate out individual rows within a range...and then you can sum each row with and count the rows >0 with , so this formula in B1 copied across should do the job with no helper cells 

Your formula is only guaranteed to work correctly if start and end times are always within working hours - because your end date is a Sunday you get the wrong result, try this formula to cope with any start/end dates 

extend as required, replace x with whatever function retrieves that value (or a cell reference containing that function) 

format result cell as a time value That works whether the period crosses midnight or not, e.g. for your example you will get 2:05, for a time period on one day like 15:00 to 22:15 you will still get the correct result, i.e. 7:15 

where A2 is the earlier of the two dates If you want to round to the "nearest" whole month you can use this version 

If you use OFFSET then the rules might be easier to follow, e.g. =OFFSET('Crank D'!B$4,(ROWS(B$8:B8)-1)*4,0) The bold parts are those that are variable.... 'Crank D'!B$4 is the first value you want B8 is the first cell in which you enter the formula 4 is the number of rows between each entry you want Change those 3 as required 

I'm not sure why you are using RC notation.... I assume you want to count rows where col A is in Feb 2013 and column B is not blank - in Excel 2010 you can use COUNTIFS for that - put the first of the month (1-Feb-2013) in D2 and use this formula in E2 

For single cell formulas There's no completely consistent rule. In general when you use ranges in formulas or functions that normally only apply to single cells then you need CTRL+SHIFT+ENTER.....so if you use 

but you also want to do the same for multiplication? As cybernard says, I don't see how you are determining which to use so for a separate multiplication formula, assuming 3 iterations at most and up to 10 digits in the original try this formula 

confirmed with CTRL+SHIFT+ENTER so that curly braces like { and } appear around the formula if all the values in A2:D2 (the weights) are the same then that formula will give you the same result as 

I would use a slightly different approach to those suggested in the link, a bit simpler I think If your data is in columns B,C and D starting at row 2 then I would select the whole range and apply this formula in conditional formatting 

select red fill or font > OK You can apply to a range of cells if you wish, just use the formula that applies to the top left cell of range. My instructions assume you are using Excel 2007 or later.... 

confirmed with CTRL+SHIFT+ENTER or if you prefer to avoid CSE then add another INDEX function like this and formula can be entered "normally" 

confirmed with CTRL+SHIFT+ENTER ....and a further improvement to make the formula more readable is to define your repetitious element, i.e. 

if the result cells in total column are formatted as (rather than ) you will see what looks like the right results....but that formula is incorrect - 24 is 24 not so you are adding days when you should be adding day Use 1 in place of 24 and you will get the right results and the right total, i.e. 

Assuming there will always be hours in the data (even if zero) and therefore a space try this formula to extract the minutes from your original data in A1 

assumes first formula in D2 - change the ROWS(D$2:D2) part depending on first cell then you can use that twice in your existing formula to replace , so that becomes this formula 

In Excel (with an "S" on the end) can be used to count with multiple conditions, so try this formula in D2 copied down 

If you only expect a single match then Peter's suggestion should do what you want. If not then you can extend Excellll's solution to get an array that only contains the matching row numbers, e.g. if rows 2 and 5 match on both columns this formula will return {2;5} 

This is an "array formula" that needs to be confirmed with CTRL+SHIFT+ENTER Another way with and ..... 

confirm with CTRL+SHIFT+ENTER and copy down. When you run out of matches you get blanks For the above I assumed everything on one sheet for simplicity but the same formula can be used to reference data on another sheet, add sheet names where appropriate. Doesn't need data in any particular order 

....then you can simply add another column as 3rd argument to return the corresponding cell from that column, i.e. 

confirmed with If there is no match then you get zero, if you want a blank instead, to distinguish between legitimate zero values you can use SMALL with IFERROR, i.e. 

I assume this problem is caused by the way excel calculates, see this link $URL$ So when you add times the result is not exactly on the minute but slightly over or under, so you don't get an exact match with your comparison Using function will work when the value is slightly over, but not under. You can check my theory by using function on your data to see if you have any values of 59 For a fix, given you are dealing with whole minutes only you could round to the nearest minute then check the minute value, e.g. for a time value in A2 

format result cell in required date format. If A2 is on an IMM date the formula gives you the next one, is that how it should work? Explanation: You can use this formula to get the first Wednesday in a month =DATE(y,m,8)-WEEKDAY(DATE(y,m,4)) for any year = y and month = m you choose The 4 can be varied to give different days of the week and the 8 can be changed to 22 to get the 3rd Wednesday of the month. In the above formula this concept is extended to produce a "table" of dates within the formula whereby the top "row" consists of the 3rd Weds of last December then the current year's Mar, Jun, Sep and Dec - row 2 has the current year's 4 dates followed by next March's. LOOKUP then looks up A2 in that table, matching with the last 3rd wed in the top row and returning the next 3rd wed from the bottom. There is a shorter method which doesn't use WEEKDAY function but uses FLOOR......but I usually avoid that method because it relies on use of one specific date system (1900 or 1904) whereas the version I provided above works whichever date system you are using. This version works with [the default] 1900 date system only 

You only need the condition to reference cells for one row, I.e If "applies to" range is C2:F172 Then make the formula apply to the first cell, like this 

Formatting normally only dictates how dates are displayed, not how your input is interpreted Regional settings will determine how input is interpreted, what region are you in? Presumably neither 01.02.2012 or 2012.02.01 are recognised as valid dates (at input). Try input as 01/02/2012 or 2012-02-01, you can still format the dates any way you want