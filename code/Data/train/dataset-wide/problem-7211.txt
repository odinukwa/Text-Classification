Unfortunately, the tests that you refer to at Top End are probably going to be your best bet at determining a VO2max for swimming. There are some testing setups where you are in an endless pool or flume, and wearing the expiration mask, but those are very specialized. If you want a water based test, the polo ones are the only ones I'm aware of. However, VO2max is not that great a metric for determining current fitness or performance. VO2max is a measurement of capacity, and is a predictor for possible endurance sport aptitude, but that's about it. As an example: If I plug in some numbers into the Rockport equation (Calculator here), it gives me a VO2max value. If all I do is drop my weight, my VO2max goes up, even if that is only accomplished by dieting and no extra fitness. If you are training, it's more of an academic number than a training metric. A better indicator of performance is obtaining your vVO2max (Velocity or speed when you reach your VO2max level), and tlimvVo2max (Time limitation, or how long you can last at vVo2max). You can get a further explanation of these at BrianMac. 

You can gain muscle while losing weight, but really only in specific circumstances, which you most likely don't fall into. You need to be fairly obese to start with, and eating the correct nutrients to support the lifting that you are doing. However, you are most likely not in that category, since you have been training regularly already. If you are in a caloric deficit, then you aren't going to be gaining muscle size, with one possible exception that I will detail below. What you will be doing is preserving lean body mass, and using fat stores to maintain the muscle that you currently have. This study suggests that adding weights to dietary restriction results in maintenance of lean body weight, but it's a little oddly worded in the abstract, as it suggests that diet + exercise and exercise only both increased mass and strength in obese women, but I don't know if the "diet" is just a change in what they are eating normally. A study using bodybuilders showed that energy restriction reduced muscle size, and theorizes that it impacts the anabolic pathways in spite of high protein intake. This makes sense intuitively, as many bodybuilders are relatively much heavier during training, even while maintaining relatively little bodyfat, and they lose quite a bit of weight while dropping down into the single digit ranges for bodyfat when prepping for a contest. Finally, another article discussing cellular biology (Which is mostly way way over my head) suggests that caloric deficits impact the pathways by which cells get the signal to grow. This article is very heavy on the cellular biology. I did find one article that suggests that people go through catabolic and anabolic phases during each day, so if you are (as they say) "fanatical" about the planning and timing, it is possible to gain while dieting. This was about the only reference I found that said it's possible to run a caloric deficit and still gain, and I don't think you can run much of a deficit or for very long. However, for the rank and file crowd, I do believe that if you are anywhere past the relative beginner stage (Who will see gains in the initial adaptation period), you cannot be in a caloric deficit and still gaining muscle. Rather, you are maintaining muscle and losing fat. For your situation, I believe that you will fall into the same area as the bodybuilders in that you might lose some size while losing the weight. 

No, you can't change the shape of your muscles without injury or surgery. You can change the size, which can change the appearance, but if you have a biceps with a short muscle belly and a long tendon, (So that your bicep peak doesn't reach to the inside of your elbow), you can't change that shape, it's genetic. Another example is your abdominals, the connective tissue that forms the "x pack" bulges is genetic. You may have 3, you might have 8, or whatever, but you can't change that. 

Not much you can do. If you are restricted enough that you can't run, and can't even lean on the bars (Much less get into aero position), its going to be just trying to keep in the best shape you can. What I would honestly do (Especially considering swim is your weakest point), is do the trainer for now. Sign up for Trainerroad, or get some of the Sufferfest videos, and work the bike as much as possible with the restrictions. When you can add the run, do that as well. Get a lot of base work in that you can build on later. For upper body, you'll probably just have to take your lumps. See how your doctor feels about situps on a bench where your feet are anchored, and make sure that you don't use your upper body at all. Once you are cleared to swim, I would get with a good swim stroke instructor (Which may or may not be a masters coach, they are not always one and the same), and work drills and distance in a 8 week(ish) swim focus, while doing maintenance work on the bike/run. A bad swim stroke can be very hard on the shoulders, so if you can correct technique now and drop your times for the swim leg at the same time, it's win/win. 

Form - Freestyle sprinting is all about efficiency and form. If your form is whonky or you are not as streamlined as you could be, then you could be costing yourself valuable time that is basically free for drills. This can really only be assessed by an on the deck instructor that can look at your form. The best ones will also utilize above and underwater video from multiple angles. Strength/Conditioning - Dryland drills are just as important as your workout routine. Flexibility in your ankles/calves and shoulders will allow greater range of motion and efficiency (See #1). Threshold/Interval work - No two ways about it, you have to spend a lot of time in the pool making it hurt. Interval is short distance, long rest done at above race pace. Threshold work is also short to medium distance, done on shorter rest, at about 80-90% (Depending) of race pace. Along with that, you need the usual form drills, distance conditioning, multiple stroke work, etc. Nutrition - Critical. You have to be properly fueled, and have quality food at that. If you are doing huge volume, then you may need to take some shortcuts with high calorie dense foods, but try to make sure that a majority of your calories are serving a purpose and not just more. Rest - Also critical. You can't perform good workouts or races when you are tired. There will be days when you feel awesome, days when you feel like dog meat. Take advantage of the great days and push extra, and relax and/or skip days when you don't feel good. 

With any stretching routine, pay close attention to how you feel. You should feel some tension, but try to relax as much as possible. ANY pain, ANYWHERE, STOP! You are either very tight, or doing the stretch wrong, and in either case to keep stretching can do some serious damage. If you have any question, google "hamstring stretches" or similar, and look at the pictures. If you would like a good reference book, "Stretching scientifically" is a good read, and there are quite a few good video references on youTube. 

10 mets on a bicycle is the equivalent of ~ 14 mph. This is a fairly easy pace and should be easy to sustain for a while, unless you have never really ridden a bike much other than a beach cruiser around the block. Here is a link for a met exercise equivalency chart, there are dozens of them scattered around the web that show MET's for various exercises. $URL$ 

With a short pool, you are limited, especially if you have an efficient flip turn. Since you are a beginner, I don't think that is a problem (Not a knock, just a fact. Flip turns take lots of practice to be effective). I would take a pull buoy with you and concentrate on form drills. As a beginner swimmer in a very technique driven sport, this would serve you the best, as it's hard to get effective aerobic work in a short length pool. I would recommend single arm drills, sculling, and concentration on early vertical forearm (EVF) and maintaining a high elbow through your pull. Although you describe yourself as a beginner, 1:40 for 100m as a sustainable pace means that you have decent fitness and decent form already. I generally regard 2:00/100m sustainable pace as the break point, in that if you can achieve that pace, you probably don't have any glaring stroke flaws holding you back. Not to say there aren't improvements to be made, but your stroke isn't really hindering your progress much. 

The most accurate method is direct calorimetry. This is basically a measurement (usually for 24 hours) of the heat produced by the human body. This is usually done in a sealed chamber to fully capture all heat produced. Next up is indirect calorimetry, where the amount of oxygen consumed and CO2 produced is directly measured, which you can then use to get calories burned. The other equations that can estimate calorie burn as as follows (For the major ones, there are other minor ones available):