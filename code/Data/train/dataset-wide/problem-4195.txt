Although I have no clue about Japan's privacy laws, I think it's a safe bet to assume that a company that reaches a certain size will not be dumb enough to behave in an obviously illegal way in public. As the process of collecting medical data is made public and it's not some shady interviewer asking about it in some backroom, it's very, very likely indeed legal. 

No. a) There is a fair chance that this is not legal in whatever country you are in or at least not legally enforceable. b) There is no way to verify that the employee abides by the rule, which means you have not mitigated the risk, you just have replaced it with a different kind of hope:"I hope the key person has no accident." is replaced by:"I hope the key person stays at home." Hope is not a risk management strategy. c) The proper way to mitigate the risk of a key person becoming unavailable for whatever reason is to invest the funds and time to have a replacement. Note that this does not necessarily mean to train another employee, but you could for example look for a contractor with similar specific knowledge and prepare a support contract on an hourly basis. 

As far as I can tell, you told your client that you will be unavailable, it is part of your contract that you can be unavailable (by the mere fact that you did not agree to be available) and your client did not request that you are available when you told them that you are not. I don't think that it is necessary to apologize. As far as I can tell, it would only raise the flag that there was a delay, while at the moment it is unclear for the client whether your unavailability (which can mean a lot of different things) had any affect on the project. I would focus on selling your results in a positive way when you are finished. 

Whether you work or not during the weekend will have no effect. Management will, no matter what, either try to improve or not. If management could be educated by their inferiors, there would be no business consultants in the world. 

Does Mary want more responsibility? Does Mary want to code more? What do we tell Mary if she asks here how to deal with a team lead who constantly tries to make her do work she hates? Did you ever actually talk with Mary about your idea to have her code more and what was her reaction? 

This wording is a bit awkward, as it implies that their website has many other bugs - which might be true, but being negative about something someone else owns is always problematic. A single letter, like replacing "many" with "any", can change the tone. So my best advice is to have someone check texts that might affect your career before you send them, not afterwards. 

Engineers, unless they are actually mentally ill, react fairly rationale. John and Dave didn't throw a die to determine if they get along or not. For example, I was teamed up with an engineer for quite some time and working together just wasn't productive. The problem was not the technical skill or the social aspect, we got along very well outside meetings, spent lunch break together, rolled our eyes together about the "insane decisions from above". But basically whenever it came down to anything that could not be proven with facts but included estimations, assessments, evaluations etc. our opinions always differed and I really mean always and by differ I mean 180°, not 10°. And because it was never about technical facts, there was never really any closure. This is a very frustrating situation. When I was asked for an assessment of the risk of a software upgrade and gave my assessment, it was guaranteed that there would be an objection that would say the complete opposite. Basically every meeting ended up with a confused product manager, a helpless project lead and two engineers who have their point of view and neither point can be proven wrong. This had a bigger negative effect than of one engineer just making a "wrong decision". Interestingly, I don't even see John as the problem. You say that he stated in front of everyone that he does not want to work with Dave. But you didn't mention a reason. Did nobody ever ask why? Not even after the meeting? Teams are productive when they gel. Some combinations of individual humans gel nearly instantly. Obviously, there must be also the opposite - teams that just don't gel and never really will. You cannot force either outcome, not even when you threaten to fire them - although this might be a solution, after all you increase your chance to get a better combination of humans. EDIT: Dave needs to accept that he has to either yield to team decisions or convince the team that his decision is the best. He can work on whatever he wants on his spare time, but at work he has to code what is decided and not what he prefers. This is the first talk you will have to have. He will likely start to debate that his actions were justified, but you should not let the conversation steer into a discussion about technical facts or best practices. The second talk is the one with John, where you actually acknowledge that you understood (not necessarily share, but understood the reasoning) his motivations and resulting actions, but that these actions are not to be carried on. Then you need to convince John to try a fresh start and also propose a path that John can take despite frustated yielding when conflicts arise - which likely involves discussing issues with you as technical lead. 

You are mixing up two different things. 1) Your annual raise. 2) Your hourly wage. You were not content with your hourly wage in comparison to your co-workers, expected the raise to fix it and were disappointed that it didn't. This is not how it works. The person deciding the annual raise might not even have a clue about your hourly wage or your performance. The annual raise is also usually not used to diminish offsets between co-workers (quite the contrary, percentage-based raises increase the offset). There is also usually no clear-cut correlation between a review and the percentage value over the years - if it's a good year for the company, raises will be better, if it's a bad year raises will be lower (if at all), no matter what your individual performance was. 3.5% for one year is a decent raise. Now - that your hourly wage is lower than that of your co-workers is a completely separate issue and you should handle it like a separate issue.